<!doctype html>
<html lang="zh"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"><title>标签: 笔记 - ntcs&#039; blog</title><link rel="manifest" href="/manifest.json"><meta name="application-name" content="ntcs&#039; blog"><meta name="msapplication-TileImage" content="img/icon.ico"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-title" content="ntcs&#039; blog"><meta name="apple-mobile-web-app-status-bar-style" content="default"><meta property="og:type" content="website"><meta property="og:title" content="ntcs&#039; blog"><meta property="og:url" content="http://naughtychas.github.io/"><meta property="og:site_name" content="ntcs&#039; blog"><meta property="og:locale" content="zh_CN"><meta property="og:image" content="http://naughtychas.github.io/img/og_image.png"><meta property="article:author" content="MXK"><meta property="twitter:card" content="summary"><meta property="twitter:image:src" content="http://naughtychas.github.io/img/og_image.png"><script type="application/ld+json">{"@context":"https://schema.org","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"http://NaughtyChas.github.io"},"headline":"ntcs' blog","image":["http://naughtychas.github.io/img/og_image.png"],"author":{"@type":"Person","name":"MXK"},"publisher":{"@type":"Organization","logo":{"@type":"ImageObject"}},"description":""}</script><link rel="icon" href="/img/icon.ico"><meta name="referrer" content="no-referrer-when-downgrade"><link rel="stylesheet" href="https://cdn.bootcdn.net/ajax/libs/font-awesome/6.1.2/css/all.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/highlight.js@9.12.0/styles/atom-one-light.css"><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Ubuntu:wght@400;600&amp;family=Source+Code+Pro"><link rel="stylesheet" href="/css/default.css"><link rel="stylesheet" href="https://cdnjs.loli.net/ajax/libs/font-awesome/5.12.0/css/all.min.css"><link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Ubuntu:400,600|Source+Code+Pro|Monda:300,300italic,400,400italic,700,700italic|Roboto Slab:300,300italic,400,400italic,700,700italic|Microsoft YaHei:300,300italic,400,400italic,700,700italic|PT Mono:300,300italic,400,400italic,700,700italic&amp;amp;subset=latin,latin-ext|Inconsolata|Itim|Lobster.css"><script src="https://cdn.jsdelivr.net/npm/jquery@3.3.1/dist/jquery.min.js"></script><script src="/js/globalUtils.js"></script><style>body>.footer,body>.navbar,body>.section{opacity:0}</style><!--!--><!--!--><script src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js" defer></script><!--!--><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/lightgallery@1.10.0/dist/css/lightgallery.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/justifiedGallery@3.8.1/dist/css/justifiedGallery.min.css"><!--!--><!--!--><!--!--><style>.pace{-webkit-pointer-events:none;pointer-events:none;-webkit-user-select:none;-moz-user-select:none;user-select:none}.pace-inactive{display:none}.pace .pace-progress{background:#3273dc;position:fixed;z-index:2000;top:0;right:100%;width:100%;height:2px}</style><script src="https://cdn.jsdelivr.net/npm/pace-js@1.2.4/pace.min.js"></script><!-- hexo injector head_end start -->
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css">

<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/hexo-math@4.0.0/dist/style.css">
<!-- hexo injector head_end end --><meta name="generator" content="Hexo 6.3.0"></head><body class="is-3-column has-navbar-fixed-top"><nav class="navbar navbar-main is-fixed-top"><div class="container"><div class="navbar-brand justify-content-center"><a class="navbar-item navbar-logo" href="/"><img src="/img/logo.png" alt="ntcs&#039; blog" height="28"></a></div><div class="navbar-menu"><div class="navbar-start"><a class="navbar-item" href="/archives">归档</a><a class="navbar-item" href="/categories">分类</a><a class="navbar-item" href="/tags">标签</a><a class="navbar-item" href="/message">留言</a><a class="navbar-item" href="/friend">友链</a><a class="navbar-item" href="/about">关于</a></div><div class="navbar-end"><a class="navbar-item search" title="搜索" href="javascript:;"><i class="fas fa-search"></i></a><a class="navbar-item" id="night-nav" title="Night Mode" href="javascript:;"><i class="fas fa-moon" id="night-icon"></i></a></div></div></div></nav><script type="text/javascript" src="/js/theme-setting.js"></script><section class="section"><div class="container"><div class="columns"><div class="column order-2 column-main is-8-tablet is-8-desktop is-6-widescreen"><div class="card"><div class="card-content"><nav class="breadcrumb" aria-label="breadcrumbs"><ul><li><a href="/tags">标签</a></li><li class="is-active"><a href="#" aria-current="page">笔记</a></li></ul></nav></div></div><div class="card"><div class="card-image"><a class="image is-7by3" href="/2023/07/01/A2CS%E7%AC%94%E8%AE%B0/"><img class="fill" src="/thumbnails/CS.jpg" alt="A2CS笔记"></a></div><article class="card-content article" role="article"><div class="article-meta size-small is-uppercase level is-mobile"><div class="level-left"><i class="far fa-calendar-plus"> </i>2023-07-01  <a class="commentCountImg" href="/2023/07/01/A2CS%E7%AC%94%E8%AE%B0/#comment-container"><span class="display-none-class">f4fef354d440d79d973c2bf25f8e464b</span><i class="far fa-comment-dots"></i> <span class="commentCount" id="f4fef354d440d79d973c2bf25f8e464b">99+</span>  </a><span class="level-item"><i class="far fa-clock"> </i>1 小时  <i class="fas fa-pencil-alt"> </i>7.5 k</span></div><div class="pin-icon"><i class="fas fa-thumbtack"></i></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2023/07/01/A2CS%E7%AC%94%E8%AE%B0/">A2CS笔记</a></h1><div class="content"><blockquote>
<p>CS课堂笔记 (A2)<br></div><div class="index-category-tag"><div class="level-item"><i class="fas fa-folder-open has-text-grey"> </i><a class="article-more button is-small link-muted index-categories" href="/categories/CS/">CS</a><span> </span><a class="article-more button is-small link-muted index-categories" href="/categories/CS/%E7%AC%94%E8%AE%B0/">笔记</a></div>  <div class="level-item"><i class="fas fa-tags has-text-grey"> </i><a class="article-more button is-small link-muted index-tags" href="/tags/%E7%AC%94%E8%AE%B0/">笔记</a><span> </span><a class="article-more button is-small link-muted index-tags" href="/tags/CIE/">CIE</a><span> </span><a class="article-more button is-small link-muted index-tags" href="/tags/%E8%AE%A1%E7%AE%97%E6%9C%BA/">计算机</a></div><hr></div><div class="level is-mobile is-flex"><div class="level-start"><div class="level-item"><a class="article-more button is-small size-small" href="/2023/07/01/A2CS%E7%AC%94%E8%AE%B0/#more">阅读更多&gt;&gt;</a></div></div><div class="level-start"><div class="level-item has-text-grey is-size-7"><time dateTime="2023-07-30T03:21:48.195Z"><i class="far fa-calendar-check"> 最后修改: </i>2023-07-30</time></div></div></div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta size-small is-uppercase level is-mobile"><div class="level-left"><i class="far fa-calendar-plus"> </i>2023-06-10  <a class="commentCountImg" href="/2023/06/10/%E6%9C%89%E5%85%B3%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0/%E6%9C%89%E5%85%B3%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0/#comment-container"><span class="display-none-class">d15bb8808442c72f026432b5e2fa76c1</span><i class="far fa-comment-dots"></i> <span class="commentCount" id="d15bb8808442c72f026432b5e2fa76c1">99+</span>  </a><span class="level-item"><i class="far fa-clock"> </i>几秒  <i class="fas fa-pencil-alt"> </i>0.1 k</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2023/06/10/%E6%9C%89%E5%85%B3%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0/%E6%9C%89%E5%85%B3%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0/">有关深度学习</a></h1><div class="content"><blockquote>
<p>自学深度学习的不完全笔记（<br></div><div class="index-category-tag"><div class="level-item"><i class="fas fa-folder-open has-text-grey"> </i><a class="article-more button is-small link-muted index-categories" href="/categories/CS/">CS</a><span> </span><a class="article-more button is-small link-muted index-categories" href="/categories/CS/%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0/">深度学习</a></div>  <div class="level-item"><i class="fas fa-tags has-text-grey"> </i><a class="article-more button is-small link-muted index-tags" href="/tags/%E7%AC%94%E8%AE%B0/">笔记</a><span> </span><a class="article-more button is-small link-muted index-tags" href="/tags/%E8%AE%A1%E7%AE%97%E6%9C%BA/">计算机</a></div><hr></div><div class="level is-mobile is-flex"><div class="level-start"><div class="level-item"><a class="article-more button is-small size-small" href="/2023/06/10/%E6%9C%89%E5%85%B3%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0/%E6%9C%89%E5%85%B3%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0/#more">阅读更多&gt;&gt;</a></div></div><div class="level-start"><div class="level-item has-text-grey is-size-7"><time dateTime="2023-06-19T15:21:08.339Z"><i class="far fa-calendar-check"> 最后修改: </i>2023-06-19</time></div></div></div></article></div><div class="card"><div class="card-image"><a class="image is-7by3" href="/2022/09/01/Python%E9%A1%B9%E7%9B%AE/"><img class="fill" src="/thumbnails/CS.jpg" alt="Python项目"></a></div><article class="card-content article" role="article"><div class="article-meta size-small is-uppercase level is-mobile"><div class="level-left"><i class="far fa-calendar-plus"> </i>2022-09-01  <a class="commentCountImg" href="/2022/09/01/Python%E9%A1%B9%E7%9B%AE/#comment-container"><span class="display-none-class">6fbb7375740c18e25ed76f0a040d83ca</span><i class="far fa-comment-dots"></i> <span class="commentCount" id="6fbb7375740c18e25ed76f0a040d83ca">99+</span>  </a><span class="level-item"><i class="far fa-clock"> </i>35 分钟  <i class="fas fa-pencil-alt"> </i>5.2 k</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2022/09/01/Python%E9%A1%B9%E7%9B%AE/">Python项目</a></h1><div class="content"><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br><span class="line">372</span><br><span class="line">373</span><br><span class="line">374</span><br><span class="line">375</span><br><span class="line">376</span><br><span class="line">377</span><br><span class="line">378</span><br><span class="line">379</span><br><span class="line">380</span><br><span class="line">381</span><br><span class="line">382</span><br><span class="line">383</span><br><span class="line">384</span><br><span class="line">385</span><br><span class="line">386</span><br><span class="line">387</span><br><span class="line">388</span><br><span class="line">389</span><br><span class="line">390</span><br><span class="line">391</span><br><span class="line">392</span><br><span class="line">393</span><br><span class="line">394</span><br><span class="line">395</span><br><span class="line">396</span><br><span class="line">397</span><br><span class="line">398</span><br><span class="line">399</span><br><span class="line">400</span><br><span class="line">401</span><br><span class="line">402</span><br><span class="line">403</span><br><span class="line">404</span><br><span class="line">405</span><br><span class="line">406</span><br><span class="line">407</span><br><span class="line">408</span><br><span class="line">409</span><br><span class="line">410</span><br><span class="line">411</span><br><span class="line">412</span><br><span class="line">413</span><br><span class="line">414</span><br><span class="line">415</span><br><span class="line">416</span><br><span class="line">417</span><br><span class="line">418</span><br><span class="line">419</span><br><span class="line">420</span><br><span class="line">421</span><br><span class="line">422</span><br><span class="line">423</span><br><span class="line">424</span><br><span class="line">425</span><br><span class="line">426</span><br><span class="line">427</span><br><span class="line">428</span><br><span class="line">429</span><br><span class="line">430</span><br><span class="line">431</span><br><span class="line">432</span><br><span class="line">433</span><br><span class="line">434</span><br><span class="line">435</span><br><span class="line">436</span><br><span class="line">437</span><br><span class="line">438</span><br><span class="line">439</span><br><span class="line">440</span><br><span class="line">441</span><br><span class="line">442</span><br><span class="line">443</span><br><span class="line">444</span><br><span class="line">445</span><br><span class="line">446</span><br><span class="line">447</span><br><span class="line">448</span><br><span class="line">449</span><br><span class="line">450</span><br><span class="line">451</span><br><span class="line">452</span><br><span class="line">453</span><br><span class="line">454</span><br><span class="line">455</span><br><span class="line">456</span><br><span class="line">457</span><br><span class="line">458</span><br><span class="line">459</span><br><span class="line">460</span><br><span class="line">461</span><br><span class="line">462</span><br><span class="line">463</span><br><span class="line">464</span><br><span class="line">465</span><br><span class="line">466</span><br><span class="line">467</span><br><span class="line">468</span><br><span class="line">469</span><br><span class="line">470</span><br><span class="line">471</span><br><span class="line">472</span><br><span class="line">473</span><br><span class="line">474</span><br><span class="line">475</span><br><span class="line">476</span><br><span class="line">477</span><br><span class="line">478</span><br><span class="line">479</span><br><span class="line">480</span><br><span class="line">481</span><br><span class="line">482</span><br><span class="line">483</span><br><span class="line">484</span><br><span class="line">485</span><br><span class="line">486</span><br><span class="line">487</span><br><span class="line">488</span><br><span class="line">489</span><br><span class="line">490</span><br><span class="line">491</span><br><span class="line">492</span><br><span class="line">493</span><br><span class="line">494</span><br><span class="line">495</span><br><span class="line">496</span><br><span class="line">497</span><br><span class="line">498</span><br><span class="line">499</span><br><span class="line">500</span><br><span class="line">501</span><br><span class="line">502</span><br><span class="line">503</span><br><span class="line">504</span><br><span class="line">505</span><br><span class="line">506</span><br><span class="line">507</span><br><span class="line">508</span><br><span class="line">509</span><br><span class="line">510</span><br><span class="line">511</span><br><span class="line">512</span><br><span class="line">513</span><br><span class="line">514</span><br><span class="line">515</span><br><span class="line">516</span><br><span class="line">517</span><br><span class="line">518</span><br><span class="line">519</span><br><span class="line">520</span><br><span class="line">521</span><br><span class="line">522</span><br><span class="line">523</span><br><span class="line">524</span><br><span class="line">525</span><br><span class="line">526</span><br><span class="line">527</span><br><span class="line">528</span><br><span class="line">529</span><br><span class="line">530</span><br><span class="line">531</span><br><span class="line">532</span><br><span class="line">533</span><br><span class="line">534</span><br><span class="line">535</span><br><span class="line">536</span><br><span class="line">537</span><br><span class="line">538</span><br><span class="line">539</span><br><span class="line">540</span><br><span class="line">541</span><br><span class="line">542</span><br><span class="line">543</span><br><span class="line">544</span><br><span class="line">545</span><br><span class="line">546</span><br><span class="line">547</span><br><span class="line">548</span><br><span class="line">549</span><br><span class="line">550</span><br><span class="line">551</span><br><span class="line">552</span><br><span class="line">553</span><br><span class="line">554</span><br><span class="line">555</span><br><span class="line">556</span><br><span class="line">557</span><br><span class="line">558</span><br><span class="line">559</span><br><span class="line">560</span><br><span class="line">561</span><br><span class="line">562</span><br><span class="line">563</span><br><span class="line">564</span><br><span class="line">565</span><br><span class="line">566</span><br><span class="line">567</span><br><span class="line">568</span><br><span class="line">569</span><br><span class="line">570</span><br><span class="line">571</span><br><span class="line">572</span><br><span class="line">573</span><br><span class="line">574</span><br><span class="line">575</span><br><span class="line">576</span><br><span class="line">577</span><br><span class="line">578</span><br><span class="line">579</span><br><span class="line">580</span><br><span class="line">581</span><br><span class="line">582</span><br><span class="line">583</span><br><span class="line">584</span><br><span class="line">585</span><br><span class="line">586</span><br><span class="line">587</span><br><span class="line">588</span><br><span class="line">589</span><br><span class="line">590</span><br><span class="line">591</span><br><span class="line">592</span><br><span class="line">593</span><br><span class="line">594</span><br><span class="line">595</span><br><span class="line">596</span><br><span class="line">597</span><br><span class="line">598</span><br><span class="line">599</span><br><span class="line">600</span><br><span class="line">601</span><br><span class="line">602</span><br><span class="line">603</span><br><span class="line">604</span><br><span class="line">605</span><br><span class="line">606</span><br><span class="line">607</span><br><span class="line">608</span><br><span class="line">609</span><br><span class="line">610</span><br><span class="line">611</span><br><span class="line">612</span><br><span class="line">613</span><br><span class="line">614</span><br><span class="line">615</span><br><span class="line">616</span><br><span class="line">617</span><br><span class="line">618</span><br><span class="line">619</span><br><span class="line">620</span><br><span class="line">621</span><br><span class="line">622</span><br><span class="line">623</span><br><span class="line">624</span><br><span class="line">625</span><br><span class="line">626</span><br><span class="line">627</span><br><span class="line">628</span><br><span class="line">629</span><br><span class="line">630</span><br><span class="line">631</span><br><span class="line">632</span><br><span class="line">633</span><br><span class="line">634</span><br><span class="line">635</span><br><span class="line">636</span><br><span class="line">637</span><br><span class="line">638</span><br><span class="line">639</span><br><span class="line">640</span><br><span class="line">641</span><br><span class="line">642</span><br><span class="line">643</span><br><span class="line">644</span><br><span class="line">645</span><br><span class="line">646</span><br><span class="line">647</span><br><span class="line">648</span><br><span class="line">649</span><br><span class="line">650</span><br><span class="line">651</span><br><span class="line">652</span><br><span class="line">653</span><br><span class="line">654</span><br><span class="line">655</span><br><span class="line">656</span><br><span class="line">657</span><br><span class="line">658</span><br><span class="line">659</span><br><span class="line">660</span><br><span class="line">661</span><br><span class="line">662</span><br><span class="line">663</span><br><span class="line">664</span><br><span class="line">665</span><br><span class="line">666</span><br><span class="line">667</span><br><span class="line">668</span><br><span class="line">669</span><br><span class="line">670</span><br><span class="line">671</span><br><span class="line">672</span><br><span class="line">673</span><br><span class="line">674</span><br><span class="line">675</span><br><span class="line">676</span><br><span class="line">677</span><br><span class="line">678</span><br><span class="line">679</span><br><span class="line">680</span><br><span class="line">681</span><br><span class="line">682</span><br><span class="line">683</span><br><span class="line">684</span><br><span class="line">685</span><br><span class="line">686</span><br><span class="line">687</span><br><span class="line">688</span><br><span class="line">689</span><br><span class="line">690</span><br><span class="line">691</span><br><span class="line">692</span><br><span class="line">693</span><br><span class="line">694</span><br><span class="line">695</span><br><span class="line">696</span><br><span class="line">697</span><br><span class="line">698</span><br><span class="line">699</span><br><span class="line">700</span><br><span class="line">701</span><br><span class="line">702</span><br><span class="line">703</span><br><span class="line">704</span><br><span class="line">705</span><br><span class="line">706</span><br><span class="line">707</span><br><span class="line">708</span><br><span class="line">709</span><br><span class="line">710</span><br><span class="line">711</span><br><span class="line">712</span><br><span class="line">713</span><br><span class="line">714</span><br><span class="line">715</span><br><span class="line">716</span><br><span class="line">717</span><br><span class="line">718</span><br><span class="line">719</span><br><span class="line">720</span><br><span class="line">721</span><br><span class="line">722</span><br><span class="line">723</span><br><span class="line">724</span><br><span class="line">725</span><br><span class="line">726</span><br><span class="line">727</span><br><span class="line">728</span><br><span class="line">729</span><br><span class="line">730</span><br><span class="line">731</span><br><span class="line">732</span><br><span class="line">733</span><br><span class="line">734</span><br><span class="line">735</span><br><span class="line">736</span><br><span class="line">737</span><br><span class="line">738</span><br><span class="line">739</span><br><span class="line">740</span><br><span class="line">741</span><br><span class="line">742</span><br><span class="line">743</span><br><span class="line">744</span><br><span class="line">745</span><br><span class="line">746</span><br><span class="line">747</span><br><span class="line">748</span><br><span class="line">749</span><br><span class="line">750</span><br><span class="line">751</span><br><span class="line">752</span><br><span class="line">753</span><br><span class="line">754</span><br><span class="line">755</span><br><span class="line">756</span><br><span class="line">757</span><br><span class="line">758</span><br><span class="line">759</span><br><span class="line">760</span><br><span class="line">761</span><br><span class="line">762</span><br><span class="line">763</span><br><span class="line">764</span><br><span class="line">765</span><br><span class="line">766</span><br><span class="line">767</span><br><span class="line">768</span><br><span class="line">769</span><br><span class="line">770</span><br><span class="line">771</span><br><span class="line">772</span><br><span class="line">773</span><br><span class="line">774</span><br><span class="line">775</span><br><span class="line">776</span><br><span class="line">777</span><br><span class="line">778</span><br><span class="line">779</span><br><span class="line">780</span><br><span class="line">781</span><br><span class="line">782</span><br><span class="line">783</span><br><span class="line">784</span><br><span class="line">785</span><br><span class="line">786</span><br><span class="line">787</span><br><span class="line">788</span><br><span class="line">789</span><br><span class="line">790</span><br><span class="line">791</span><br><span class="line">792</span><br><span class="line">793</span><br><span class="line">794</span><br><span class="line">795</span><br><span class="line">796</span><br><span class="line">797</span><br><span class="line">798</span><br><span class="line">799</span><br><span class="line">800</span><br><span class="line">801</span><br><span class="line">802</span><br><span class="line">803</span><br><span class="line">804</span><br><span class="line">805</span><br><span class="line">806</span><br><span class="line">807</span><br><span class="line">808</span><br><span class="line">809</span><br><span class="line">810</span><br><span class="line">811</span><br><span class="line">812</span><br><span class="line">813</span><br><span class="line">814</span><br><span class="line">815</span><br><span class="line">816</span><br><span class="line">817</span><br><span class="line">818</span><br><span class="line">819</span><br><span class="line">820</span><br><span class="line">821</span><br><span class="line">822</span><br><span class="line">823</span><br><span class="line">824</span><br><span class="line">825</span><br><span class="line">826</span><br><span class="line">827</span><br><span class="line">828</span><br><span class="line">829</span><br><span class="line">830</span><br><span class="line">831</span><br><span class="line">832</span><br><span class="line">833</span><br><span class="line">834</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">## This Python 3 environment comes with many helpful analytics libraries installed</span></span><br><span class="line"><span class="comment"># It is defined by the kaggle/python Docker image: https://github.com/kaggle/docker-python</span></span><br><span class="line"><span class="comment"># For example, here's several helpful packages to load</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np <span class="comment"># linear algebra</span></span><br><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd <span class="comment"># data processing, CSV file I/O (e.g. pd.read_csv)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Input data files are available in the read-only "../input/" directory</span></span><br><span class="line"><span class="comment"># For example, running this (by clicking run or pressing Shift+Enter) will list all files under the input directory</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">for</span> dirname, _, filenames <span class="keyword">in</span> os.walk(<span class="string">'/kaggle/input'</span>):</span><br><span class="line">    <span class="keyword">for</span> filename <span class="keyword">in</span> filenames:</span><br><span class="line">        <span class="built_in">print</span>(os.path.join(dirname, filename))</span><br><span class="line"></span><br><span class="line"><span class="comment"># You can write up to 20GB to the current directory (/kaggle/working/) that gets preserved as output when you create a version using "Save &amp; Run All"</span></span><br><span class="line"><span class="comment"># You can also write temporary files to /kaggle/temp/, but they won't be saved outside of the current session</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line"></span><br><span class="line"><span class="string">"""# The Project</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">The idea here is to simulate the FIFA 2022 World Cup games with machine learning, in order to predict the competition's winner. The project uses two datasets: [International football results from 1872 to 2022](https://www.kaggle.com/datasets/martj42/international-football-results-from-1872-to-2017) and [FIFA World Ranking 1992-2022](https://www.kaggle.com/datasets/cashncarry/fifaworldranking)</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">I've used the same logic that was used in the [Soccer World Cup 2018 Winner</span></span><br><span class="line"><span class="string">](https://www.kaggle.com/code/agostontorok/soccer-world-cup-2018-winner) notebook, that models the problem as binary classification one. I used this to make more easy to analyze model's results, so the model predicts between win from home team and draw/win from away team. Then, to remove the advantage of away team, I predicted the results changing teams from away and home (because there is not home advantage in World Cup), and used as probabilities the mean of the two predictions.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"># Data Preparation</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">Here, I'll prepare the data to apply feature engineering methods that will create the database in order to apply Machine Learning algorithms.</span></span><br><span class="line"><span class="string">"""</span></span><br><span class="line"></span><br><span class="line">df =  pd.read_csv(<span class="string">"results.csv"</span>)</span><br><span class="line"></span><br><span class="line">df[<span class="string">"date"</span>] = pd.to_datetime(df[<span class="string">"date"</span>])</span><br><span class="line"></span><br><span class="line">df.isna().<span class="built_in">sum</span>()</span><br><span class="line"></span><br><span class="line">df.dropna(inplace=<span class="literal">True</span>)</span><br><span class="line"></span><br><span class="line">df.dtypes</span><br><span class="line"></span><br><span class="line"><span class="string">"""The dataset used will be the FIFA Games between 2018, from after the 2018 World Cup to the last games before the 2022 World Cup. The idea is to analyze just the games played at the preparation and classification to WC."""</span></span><br><span class="line"></span><br><span class="line">df.sort_values(<span class="string">"date"</span>).tail()</span><br><span class="line"></span><br><span class="line">df = df[(df[<span class="string">"date"</span>] &gt;= <span class="string">"2018-8-1"</span>)].reset_index(drop=<span class="literal">True</span>)</span><br><span class="line"></span><br><span class="line">df.sort_values(<span class="string">"date"</span>).tail()</span><br><span class="line"></span><br><span class="line">df.home_team.value_counts()</span><br><span class="line"></span><br><span class="line">rank = pd.read_csv(<span class="string">"fifa_ranking-2023-07-20.csv"</span>)</span><br><span class="line"></span><br><span class="line">rank[<span class="string">"rank_date"</span>] = pd.to_datetime(rank[<span class="string">"rank_date"</span>])</span><br><span class="line">rank = rank[(rank[<span class="string">"rank_date"</span>] &gt;= <span class="string">"2018-8-1"</span>)].reset_index(drop=<span class="literal">True</span>)</span><br><span class="line"></span><br><span class="line"><span class="string">"""Some teams in the World Cup have different names in the ranking's dataset. So, it's needed to adjust."""</span></span><br><span class="line"></span><br><span class="line">rank[<span class="string">"country_full"</span>] = rank[<span class="string">"country_full"</span>].<span class="built_in">str</span>.replace(<span class="string">"IR Iran"</span>, <span class="string">"Iran"</span>).<span class="built_in">str</span>.replace(<span class="string">"Korea Republic"</span>, <span class="string">"South Korea"</span>).<span class="built_in">str</span>.replace(<span class="string">"USA"</span>, <span class="string">"United States"</span>)</span><br><span class="line"></span><br><span class="line"><span class="string">"""The merge is made in order to get a dataset FIFA games and its rankings."""</span></span><br><span class="line"></span><br><span class="line">rank = rank.set_index([<span class="string">'rank_date'</span>]).groupby([<span class="string">'country_full'</span>], group_keys=<span class="literal">False</span>).resample(<span class="string">'D'</span>).first().fillna(method=<span class="string">'ffill'</span>).reset_index()</span><br><span class="line"></span><br><span class="line">df_wc_ranked = df.merge(rank[[<span class="string">"country_full"</span>, <span class="string">"total_points"</span>, <span class="string">"previous_points"</span>, <span class="string">"rank"</span>, <span class="string">"rank_change"</span>, <span class="string">"rank_date"</span>]], left_on=[<span class="string">"date"</span>, <span class="string">"home_team"</span>], right_on=[<span class="string">"rank_date"</span>, <span class="string">"country_full"</span>]).drop([<span class="string">"rank_date"</span>, <span class="string">"country_full"</span>], axis=<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">df_wc_ranked = df_wc_ranked.merge(rank[[<span class="string">"country_full"</span>, <span class="string">"total_points"</span>, <span class="string">"previous_points"</span>, <span class="string">"rank"</span>, <span class="string">"rank_change"</span>, <span class="string">"rank_date"</span>]], left_on=[<span class="string">"date"</span>, <span class="string">"away_team"</span>], right_on=[<span class="string">"rank_date"</span>, <span class="string">"country_full"</span>], suffixes=(<span class="string">"_home"</span>, <span class="string">"_away"</span>)).drop([<span class="string">"rank_date"</span>, <span class="string">"country_full"</span>], axis=<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">df_wc_ranked[(df_wc_ranked.home_team == <span class="string">"Brazil"</span>) | (df_wc_ranked.away_team == <span class="string">"Brazil"</span>)].tail(<span class="number">10</span>)</span><br><span class="line"></span><br><span class="line"><span class="string">"""Now, we have the data ready to create features based on the games' results and FIFA rankings.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"># Features Engineering</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">The idea here is to create possible features that have impact on predicting football games. By intuition, we say that features that impact could be:</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">- Past game points made</span></span><br><span class="line"><span class="string">- Past goals scored and suffered</span></span><br><span class="line"><span class="string">- The importance of game (friendly or not)</span></span><br><span class="line"><span class="string">- Rank of the teams</span></span><br><span class="line"><span class="string">- Rank increasement of the teams</span></span><br><span class="line"><span class="string">- Goals made and suffered by ranking faced</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">So, the first thing to do is create the feature that says which team won and how much points they made at game.</span></span><br><span class="line"><span class="string">"""</span></span><br><span class="line"></span><br><span class="line">df = df_wc_ranked</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">result_finder</span>(<span class="params">home, away</span>):</span><br><span class="line">    <span class="keyword">if</span> home &gt; away:</span><br><span class="line">        <span class="keyword">return</span> pd.Series([<span class="number">0</span>, <span class="number">3</span>, <span class="number">0</span>])</span><br><span class="line">    <span class="keyword">if</span> home &lt; away:</span><br><span class="line">        <span class="keyword">return</span> pd.Series([<span class="number">1</span>, <span class="number">0</span>, <span class="number">3</span>])</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">return</span> pd.Series([<span class="number">2</span>, <span class="number">1</span>, <span class="number">1</span>])</span><br><span class="line"></span><br><span class="line">results = df.apply(<span class="keyword">lambda</span> x: result_finder(x[<span class="string">"home_score"</span>], x[<span class="string">"away_score"</span>]), axis=<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">df[[<span class="string">"result"</span>, <span class="string">"home_team_points"</span>, <span class="string">"away_team_points"</span>]] = results</span><br><span class="line"></span><br><span class="line"><span class="string">"""The game points are 3 for win, 1 for draw and 0 for lose and are different than the FIFA rank points that are already in the database. Also, it's supposed that FIFA Rank points and FIFA Ranking of the same team are negative correlated, and we should use only one of them to create new features. This supposition is checked below:"""</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> seaborn <span class="keyword">as</span> sns</span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"></span><br><span class="line">plt.figure(figsize=(<span class="number">15</span>, <span class="number">10</span>))</span><br><span class="line">sns.heatmap(df[[<span class="string">"total_points_home"</span>, <span class="string">"rank_home"</span>, <span class="string">"total_points_away"</span>, <span class="string">"rank_away"</span>]].corr())</span><br><span class="line">plt.show()</span><br><span class="line"></span><br><span class="line"><span class="string">"""Now, we create columns that will help in the creation of the features: ranking difference, points won at the game vs. team faced rank, and goals difference in the game. All features that are not differences should be created for the two teams (away and home)."""</span></span><br><span class="line"></span><br><span class="line">df[<span class="string">"rank_dif"</span>] = df[<span class="string">"rank_home"</span>] - df[<span class="string">"rank_away"</span>]</span><br><span class="line">df[<span class="string">"sg"</span>] = df[<span class="string">"home_score"</span>] - df[<span class="string">"away_score"</span>]</span><br><span class="line">df[<span class="string">"points_home_by_rank"</span>] = df[<span class="string">"home_team_points"</span>]/df[<span class="string">"rank_away"</span>]</span><br><span class="line">df[<span class="string">"points_away_by_rank"</span>] = df[<span class="string">"away_team_points"</span>]/df[<span class="string">"rank_home"</span>]</span><br><span class="line"></span><br><span class="line"><span class="string">"""In order to create the features, I'll separate the dataset in home team's and away team's dataset, unify them and calculate the past game values. After that, I'll separate again and merge them, retrieving the original dataset. This proccess optimizes the creation of the features."""</span></span><br><span class="line"></span><br><span class="line">home_team = df[[<span class="string">"date"</span>, <span class="string">"home_team"</span>, <span class="string">"home_score"</span>, <span class="string">"away_score"</span>, <span class="string">"rank_home"</span>, <span class="string">"rank_away"</span>,<span class="string">"rank_change_home"</span>, <span class="string">"total_points_home"</span>, <span class="string">"result"</span>, <span class="string">"rank_dif"</span>, <span class="string">"points_home_by_rank"</span>, <span class="string">"home_team_points"</span>]]</span><br><span class="line"></span><br><span class="line">away_team = df[[<span class="string">"date"</span>, <span class="string">"away_team"</span>, <span class="string">"away_score"</span>, <span class="string">"home_score"</span>, <span class="string">"rank_away"</span>, <span class="string">"rank_home"</span>,<span class="string">"rank_change_away"</span>, <span class="string">"total_points_away"</span>, <span class="string">"result"</span>, <span class="string">"rank_dif"</span>, <span class="string">"points_away_by_rank"</span>, <span class="string">"away_team_points"</span>]]</span><br><span class="line"></span><br><span class="line">home_team.columns = [h.replace(<span class="string">"home_"</span>, <span class="string">""</span>).replace(<span class="string">"_home"</span>, <span class="string">""</span>).replace(<span class="string">"away_"</span>, <span class="string">"suf_"</span>).replace(<span class="string">"_away"</span>, <span class="string">"_suf"</span>) <span class="keyword">for</span> h <span class="keyword">in</span> home_team.columns]</span><br><span class="line"></span><br><span class="line">away_team.columns = [a.replace(<span class="string">"away_"</span>, <span class="string">""</span>).replace(<span class="string">"_away"</span>, <span class="string">""</span>).replace(<span class="string">"home_"</span>, <span class="string">"suf_"</span>).replace(<span class="string">"_home"</span>, <span class="string">"_suf"</span>) <span class="keyword">for</span> a <span class="keyword">in</span> away_team.columns]</span><br><span class="line"></span><br><span class="line">team_stats = home_team.append(away_team)<span class="comment">#.sort_values("date")</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#this column will be used to calculate features for simulation</span></span><br><span class="line">team_stats_raw = team_stats.copy()</span><br><span class="line"></span><br><span class="line"><span class="string">"""Now, we have a database ready to create predictive features. They will be:</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">- Mean goals of the team in World Cup Cycle.</span></span><br><span class="line"><span class="string">- Mean goals of the team in last 5 games.</span></span><br><span class="line"><span class="string">- Mean goals suffered of the team in World Cup Cycle.</span></span><br><span class="line"><span class="string">- Mean goals suffered of the team in last 5 games.</span></span><br><span class="line"><span class="string">- Mean FIFA Rank that team faced in World Cup Cycle.</span></span><br><span class="line"><span class="string">- Mean FIFA Rank that team faced in last 5 games.</span></span><br><span class="line"><span class="string">- FIFA Points won at the cycle.</span></span><br><span class="line"><span class="string">- FIFA Points won in last 5 games.</span></span><br><span class="line"><span class="string">- Mean game points at the Cycle.</span></span><br><span class="line"><span class="string">- Mean game points at last 5 games.</span></span><br><span class="line"><span class="string">- Mean game points by rank faced at the Cycle.</span></span><br><span class="line"><span class="string">- Mean game points by rank faced at last 5 games.</span></span><br><span class="line"><span class="string">"""</span></span><br><span class="line"></span><br><span class="line">stats_val = []</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> index, row <span class="keyword">in</span> team_stats.iterrows():</span><br><span class="line">    team = row[<span class="string">"team"</span>]</span><br><span class="line">    date = row[<span class="string">"date"</span>]</span><br><span class="line">    past_games = team_stats.loc[(team_stats[<span class="string">"team"</span>] == team) &amp; (team_stats[<span class="string">"date"</span>] &lt; date)].sort_values(by=[<span class="string">'date'</span>], ascending=<span class="literal">False</span>)</span><br><span class="line">    last5 = past_games.head(<span class="number">5</span>)</span><br><span class="line"></span><br><span class="line">    goals = past_games[<span class="string">"score"</span>].mean()</span><br><span class="line">    goals_l5 = last5[<span class="string">"score"</span>].mean()</span><br><span class="line"></span><br><span class="line">    goals_suf = past_games[<span class="string">"suf_score"</span>].mean()</span><br><span class="line">    goals_suf_l5 = last5[<span class="string">"suf_score"</span>].mean()</span><br><span class="line"></span><br><span class="line">    rank = past_games[<span class="string">"rank_suf"</span>].mean()</span><br><span class="line">    rank_l5 = last5[<span class="string">"rank_suf"</span>].mean()</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">len</span>(last5) &gt; <span class="number">0</span>:</span><br><span class="line">        points = past_games[<span class="string">"total_points"</span>].values[<span class="number">0</span>] - past_games[<span class="string">"total_points"</span>].values[-<span class="number">1</span>]<span class="comment">#qtd de pontos ganhos</span></span><br><span class="line">        points_l5 = last5[<span class="string">"total_points"</span>].values[<span class="number">0</span>] - last5[<span class="string">"total_points"</span>].values[-<span class="number">1</span>]</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        points = <span class="number">0</span></span><br><span class="line">        points_l5 = <span class="number">0</span></span><br><span class="line"></span><br><span class="line">    gp = past_games[<span class="string">"team_points"</span>].mean()</span><br><span class="line">    gp_l5 = last5[<span class="string">"team_points"</span>].mean()</span><br><span class="line"></span><br><span class="line">    gp_rank = past_games[<span class="string">"points_by_rank"</span>].mean()</span><br><span class="line">    gp_rank_l5 = last5[<span class="string">"points_by_rank"</span>].mean()</span><br><span class="line"></span><br><span class="line">    stats_val.append([goals, goals_l5, goals_suf, goals_suf_l5, rank, rank_l5, points, points_l5, gp, gp_l5, gp_rank, gp_rank_l5])</span><br><span class="line"></span><br><span class="line">stats_cols = [<span class="string">"goals_mean"</span>, <span class="string">"goals_mean_l5"</span>, <span class="string">"goals_suf_mean"</span>, <span class="string">"goals_suf_mean_l5"</span>, <span class="string">"rank_mean"</span>, <span class="string">"rank_mean_l5"</span>, <span class="string">"points_mean"</span>, <span class="string">"points_mean_l5"</span>, <span class="string">"game_points_mean"</span>, <span class="string">"game_points_mean_l5"</span>, <span class="string">"game_points_rank_mean"</span>, <span class="string">"game_points_rank_mean_l5"</span>]</span><br><span class="line"></span><br><span class="line">stats_df = pd.DataFrame(stats_val, columns=stats_cols)</span><br><span class="line"></span><br><span class="line">full_df = pd.concat([team_stats.reset_index(drop=<span class="literal">True</span>), stats_df], axis=<span class="number">1</span>, ignore_index=<span class="literal">False</span>)</span><br><span class="line"></span><br><span class="line">home_team_stats = full_df.iloc[:<span class="built_in">int</span>(full_df.shape[<span class="number">0</span>]/<span class="number">2</span>),:]</span><br><span class="line">away_team_stats = full_df.iloc[<span class="built_in">int</span>(full_df.shape[<span class="number">0</span>]/<span class="number">2</span>):,:]</span><br><span class="line"></span><br><span class="line"><span class="string">"""The new columns:"""</span></span><br><span class="line"></span><br><span class="line">home_team_stats.columns[-<span class="number">12</span>:]</span><br><span class="line"></span><br><span class="line">home_team_stats = home_team_stats[home_team_stats.columns[-<span class="number">12</span>:]]</span><br><span class="line">away_team_stats = away_team_stats[away_team_stats.columns[-<span class="number">12</span>:]]</span><br><span class="line"></span><br><span class="line">home_team_stats.columns = [<span class="string">'home_'</span>+<span class="built_in">str</span>(col) <span class="keyword">for</span> col <span class="keyword">in</span> home_team_stats.columns]</span><br><span class="line">away_team_stats.columns = [<span class="string">'away_'</span>+<span class="built_in">str</span>(col) <span class="keyword">for</span> col <span class="keyword">in</span> away_team_stats.columns]</span><br><span class="line"></span><br><span class="line"><span class="string">"""In order to unify the database, is needed to add home_ and away_ suffix for each column. After that, the data is ready to be merged."""</span></span><br><span class="line"></span><br><span class="line">match_stats = pd.concat([home_team_stats, away_team_stats.reset_index(drop=<span class="literal">True</span>)], axis=<span class="number">1</span>, ignore_index=<span class="literal">False</span>)</span><br><span class="line"></span><br><span class="line">full_df = pd.concat([df, match_stats.reset_index(drop=<span class="literal">True</span>)], axis=<span class="number">1</span>, ignore_index=<span class="literal">False</span>)</span><br><span class="line"></span><br><span class="line">full_df.columns</span><br><span class="line"></span><br><span class="line"><span class="string">"""Now, to quantify game importance, is created a column that finds competition of the game."""</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">find_friendly</span>(<span class="params">x</span>):</span><br><span class="line">    <span class="keyword">if</span> x == <span class="string">"Friendly"</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="number">1</span></span><br><span class="line">    <span class="keyword">else</span>: <span class="keyword">return</span> <span class="number">0</span></span><br><span class="line"></span><br><span class="line">full_df[<span class="string">"is_friendly"</span>] = full_df[<span class="string">"tournament"</span>].apply(<span class="keyword">lambda</span> x: find_friendly(x))</span><br><span class="line"></span><br><span class="line">full_df = pd.get_dummies(full_df, columns=[<span class="string">"is_friendly"</span>])</span><br><span class="line"></span><br><span class="line">full_df.columns</span><br><span class="line"></span><br><span class="line"><span class="string">"""And, after that, we select only columns that will help in Features' analysis."""</span></span><br><span class="line"></span><br><span class="line">base_df = full_df[[<span class="string">"date"</span>, <span class="string">"home_team"</span>, <span class="string">"away_team"</span>, <span class="string">"rank_home"</span>, <span class="string">"rank_away"</span>,<span class="string">"home_score"</span>, <span class="string">"away_score"</span>,<span class="string">"result"</span>, <span class="string">"rank_dif"</span>, <span class="string">"rank_change_home"</span>, <span class="string">"rank_change_away"</span>, <span class="string">'home_goals_mean'</span>,</span><br><span class="line">       <span class="string">'home_goals_mean_l5'</span>, <span class="string">'home_goals_suf_mean'</span>, <span class="string">'home_goals_suf_mean_l5'</span>,</span><br><span class="line">       <span class="string">'home_rank_mean'</span>, <span class="string">'home_rank_mean_l5'</span>, <span class="string">'home_points_mean'</span>,</span><br><span class="line">       <span class="string">'home_points_mean_l5'</span>, <span class="string">'away_goals_mean'</span>, <span class="string">'away_goals_mean_l5'</span>,</span><br><span class="line">       <span class="string">'away_goals_suf_mean'</span>, <span class="string">'away_goals_suf_mean_l5'</span>, <span class="string">'away_rank_mean'</span>,</span><br><span class="line">       <span class="string">'away_rank_mean_l5'</span>, <span class="string">'away_points_mean'</span>, <span class="string">'away_points_mean_l5'</span>,<span class="string">'home_game_points_mean'</span>, <span class="string">'home_game_points_mean_l5'</span>,</span><br><span class="line">       <span class="string">'home_game_points_rank_mean'</span>, <span class="string">'home_game_points_rank_mean_l5'</span>,<span class="string">'away_game_points_mean'</span>,</span><br><span class="line">       <span class="string">'away_game_points_mean_l5'</span>, <span class="string">'away_game_points_rank_mean'</span>,</span><br><span class="line">       <span class="string">'away_game_points_rank_mean_l5'</span>,</span><br><span class="line">       <span class="string">'is_friendly_0'</span>, <span class="string">'is_friendly_1'</span>]]</span><br><span class="line"></span><br><span class="line">base_df.tail()</span><br><span class="line"></span><br><span class="line">base_df.isna().<span class="built_in">sum</span>()</span><br><span class="line"></span><br><span class="line"><span class="string">"""The games with NA are the ones who mean could not be calculated (games from the beginning of the dataset). Those will be dropped."""</span></span><br><span class="line"></span><br><span class="line">base_df_no_fg = base_df.dropna()</span><br><span class="line"></span><br><span class="line"><span class="string">"""# Data Analysis</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">Now, we need to analyze all features that were created and check if they have predictive power. Also, if they don't have, we need to create some that have, like differences of home and away teams. To analyze the predictive power, I'll assign draw games as a lose of the home team and will create a binary problem.</span></span><br><span class="line"><span class="string">"""</span></span><br><span class="line"></span><br><span class="line">df = base_df_no_fg</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">no_draw</span>(<span class="params">x</span>):</span><br><span class="line">    <span class="keyword">if</span> x == <span class="number">2</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="number">1</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">return</span> x</span><br><span class="line"></span><br><span class="line">df[<span class="string">"target"</span>] = df[<span class="string">"result"</span>].apply(<span class="keyword">lambda</span> x: no_draw(x))</span><br><span class="line"></span><br><span class="line"><span class="string">"""Analysis that will be made:</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">- Violin and boxplot to analyze if the features have different distributions according to the target</span></span><br><span class="line"><span class="string">- Scatter plots to analyze correlations</span></span><br><span class="line"><span class="string">"""</span></span><br><span class="line"></span><br><span class="line">data1 = df[<span class="built_in">list</span>(df.columns[<span class="number">8</span>:<span class="number">20</span>].values) + [<span class="string">"target"</span>]]</span><br><span class="line">data2 = df[df.columns[<span class="number">20</span>:]]</span><br><span class="line"></span><br><span class="line">scaled = (data1[:-<span class="number">1</span>] - data1[:-<span class="number">1</span>].mean()) / data1[:-<span class="number">1</span>].std()</span><br><span class="line">scaled[<span class="string">"target"</span>] = data1[<span class="string">"target"</span>]</span><br><span class="line">violin1 = pd.melt(scaled,id_vars=<span class="string">"target"</span>, var_name=<span class="string">"features"</span>, value_name=<span class="string">"value"</span>)</span><br><span class="line"></span><br><span class="line">scaled = (data2[:-<span class="number">1</span>] - data2[:-<span class="number">1</span>].mean()) / data2[:-<span class="number">1</span>].std()</span><br><span class="line">scaled[<span class="string">"target"</span>] = data2[<span class="string">"target"</span>]</span><br><span class="line">violin2 = pd.melt(scaled,id_vars=<span class="string">"target"</span>, var_name=<span class="string">"features"</span>, value_name=<span class="string">"value"</span>)</span><br><span class="line"></span><br><span class="line">plt.figure(figsize=(<span class="number">15</span>,<span class="number">10</span>))</span><br><span class="line">sns.violinplot(x=<span class="string">"features"</span>, y=<span class="string">"value"</span>, hue=<span class="string">"target"</span>, data=violin1,split=<span class="literal">True</span>, inner=<span class="string">"quart"</span>)</span><br><span class="line">plt.xticks(rotation=<span class="number">90</span>)</span><br><span class="line">plt.show()</span><br><span class="line"></span><br><span class="line">plt.figure(figsize=(<span class="number">15</span>,<span class="number">10</span>))</span><br><span class="line">sns.violinplot(x=<span class="string">"features"</span>, y=<span class="string">"value"</span>, hue=<span class="string">"target"</span>, data=violin2,split=<span class="literal">True</span>, inner=<span class="string">"quart"</span>)</span><br><span class="line">plt.xticks(rotation=<span class="number">90</span>)</span><br><span class="line">plt.show()</span><br><span class="line"></span><br><span class="line"><span class="string">"""With the plots, we find that rank difference is the only good separator of the data. But, we can create features that get the differences between home and away team and analyze if they are good separating the data."""</span></span><br><span class="line"></span><br><span class="line">dif = df.copy()</span><br><span class="line">dif.loc[:, <span class="string">"goals_dif"</span>] = dif[<span class="string">"home_goals_mean"</span>] - dif[<span class="string">"away_goals_mean"</span>]</span><br><span class="line">dif.loc[:, <span class="string">"goals_dif_l5"</span>] = dif[<span class="string">"home_goals_mean_l5"</span>] - dif[<span class="string">"away_goals_mean_l5"</span>]</span><br><span class="line">dif.loc[:, <span class="string">"goals_suf_dif"</span>] = dif[<span class="string">"home_goals_suf_mean"</span>] - dif[<span class="string">"away_goals_suf_mean"</span>]</span><br><span class="line">dif.loc[:, <span class="string">"goals_suf_dif_l5"</span>] = dif[<span class="string">"home_goals_suf_mean_l5"</span>] - dif[<span class="string">"away_goals_suf_mean_l5"</span>]</span><br><span class="line">dif.loc[:, <span class="string">"goals_made_suf_dif"</span>] = dif[<span class="string">"home_goals_mean"</span>] - dif[<span class="string">"away_goals_suf_mean"</span>]</span><br><span class="line">dif.loc[:, <span class="string">"goals_made_suf_dif_l5"</span>] = dif[<span class="string">"home_goals_mean_l5"</span>] - dif[<span class="string">"away_goals_suf_mean_l5"</span>]</span><br><span class="line">dif.loc[:, <span class="string">"goals_suf_made_dif"</span>] = dif[<span class="string">"home_goals_suf_mean"</span>] - dif[<span class="string">"away_goals_mean"</span>]</span><br><span class="line">dif.loc[:, <span class="string">"goals_suf_made_dif_l5"</span>] = dif[<span class="string">"home_goals_suf_mean_l5"</span>] - dif[<span class="string">"away_goals_mean_l5"</span>]</span><br><span class="line"></span><br><span class="line">data_difs = dif.iloc[:, -<span class="number">8</span>:]</span><br><span class="line">scaled = (data_difs - data_difs.mean()) / data_difs.std()</span><br><span class="line">scaled[<span class="string">"target"</span>] = data2[<span class="string">"target"</span>]</span><br><span class="line">violin = pd.melt(scaled,id_vars=<span class="string">"target"</span>, var_name=<span class="string">"features"</span>, value_name=<span class="string">"value"</span>)</span><br><span class="line"></span><br><span class="line">plt.figure(figsize=(<span class="number">10</span>,<span class="number">10</span>))</span><br><span class="line">sns.violinplot(x=<span class="string">"features"</span>, y=<span class="string">"value"</span>, hue=<span class="string">"target"</span>, data=violin,split=<span class="literal">True</span>, inner=<span class="string">"quart"</span>)</span><br><span class="line">plt.xticks(rotation=<span class="number">90</span>)</span><br><span class="line">plt.show()</span><br><span class="line"></span><br><span class="line"><span class="string">"""With that plot, we see that goal differences are good separator, and goals suffered difference too. Differences between goals made and goals suffered of the teams are not very good separators.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">Now, we have 5 features:</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">- rank_dif</span></span><br><span class="line"><span class="string">- goals_dif</span></span><br><span class="line"><span class="string">- goals_dif_l5</span></span><br><span class="line"><span class="string">- goals_suf_dif</span></span><br><span class="line"><span class="string">- goals_suf_dif_l5</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">We can create other features, like differences of points made, differences of points made by rank faced and differences of rank faced.</span></span><br><span class="line"><span class="string">"""</span></span><br><span class="line"></span><br><span class="line">dif.loc[:, <span class="string">"dif_points"</span>] = dif[<span class="string">"home_game_points_mean"</span>] - dif[<span class="string">"away_game_points_mean"</span>]</span><br><span class="line">dif.loc[:, <span class="string">"dif_points_l5"</span>] = dif[<span class="string">"home_game_points_mean_l5"</span>] - dif[<span class="string">"away_game_points_mean_l5"</span>]</span><br><span class="line">dif.loc[:, <span class="string">"dif_points_rank"</span>] = dif[<span class="string">"home_game_points_rank_mean"</span>] - dif[<span class="string">"away_game_points_rank_mean"</span>]</span><br><span class="line">dif.loc[:, <span class="string">"dif_points_rank_l5"</span>] = dif[<span class="string">"home_game_points_rank_mean_l5"</span>] - dif[<span class="string">"away_game_points_rank_mean_l5"</span>]</span><br><span class="line"></span><br><span class="line">dif.loc[:, <span class="string">"dif_rank_agst"</span>] = dif[<span class="string">"home_rank_mean"</span>] - dif[<span class="string">"away_rank_mean"</span>]</span><br><span class="line">dif.loc[:, <span class="string">"dif_rank_agst_l5"</span>] = dif[<span class="string">"home_rank_mean_l5"</span>] - dif[<span class="string">"away_rank_mean_l5"</span>]</span><br><span class="line"></span><br><span class="line"><span class="string">"""Also, we can calculate goals made and suffered by rank, and check this difference."""</span></span><br><span class="line"></span><br><span class="line">dif.loc[:, <span class="string">"goals_per_ranking_dif"</span>] = (dif[<span class="string">"home_goals_mean"</span>] / dif[<span class="string">"home_rank_mean"</span>]) - (dif[<span class="string">"away_goals_mean"</span>] / dif[<span class="string">"away_rank_mean"</span>])</span><br><span class="line">dif.loc[:, <span class="string">"goals_per_ranking_suf_dif"</span>] = (dif[<span class="string">"home_goals_suf_mean"</span>] / dif[<span class="string">"home_rank_mean"</span>]) - (dif[<span class="string">"away_goals_suf_mean"</span>] / dif[<span class="string">"away_rank_mean"</span>])</span><br><span class="line">dif.loc[:, <span class="string">"goals_per_ranking_dif_l5"</span>] = (dif[<span class="string">"home_goals_mean_l5"</span>] / dif[<span class="string">"home_rank_mean"</span>]) - (dif[<span class="string">"away_goals_mean_l5"</span>] / dif[<span class="string">"away_rank_mean"</span>])</span><br><span class="line">dif.loc[:, <span class="string">"goals_per_ranking_suf_dif_l5"</span>] = (dif[<span class="string">"home_goals_suf_mean_l5"</span>] / dif[<span class="string">"home_rank_mean"</span>]) - (dif[<span class="string">"away_goals_suf_mean_l5"</span>] / dif[<span class="string">"away_rank_mean"</span>])</span><br><span class="line"></span><br><span class="line">data_difs = dif.iloc[:, -<span class="number">10</span>:]</span><br><span class="line">scaled = (data_difs - data_difs.mean()) / data_difs.std()</span><br><span class="line">scaled[<span class="string">"target"</span>] = data2[<span class="string">"target"</span>]</span><br><span class="line">violin = pd.melt(scaled,id_vars=<span class="string">"target"</span>, var_name=<span class="string">"features"</span>, value_name=<span class="string">"value"</span>)</span><br><span class="line"></span><br><span class="line">plt.figure(figsize=(<span class="number">15</span>,<span class="number">10</span>))</span><br><span class="line">sns.violinplot(x=<span class="string">"features"</span>, y=<span class="string">"value"</span>, hue=<span class="string">"target"</span>, data=violin,split=<span class="literal">True</span>, inner=<span class="string">"quart"</span>)</span><br><span class="line">plt.xticks(rotation=<span class="number">90</span>)</span><br><span class="line">plt.show()</span><br><span class="line"></span><br><span class="line"><span class="string">"""Due to the low values, the violin plot was not a good choice to analyze if features are really separating the data in this case. We will see then the boxplot:"""</span></span><br><span class="line"></span><br><span class="line">plt.figure(figsize=(<span class="number">15</span>,<span class="number">10</span>))</span><br><span class="line">sns.boxplot(x=<span class="string">"features"</span>, y=<span class="string">"value"</span>, hue=<span class="string">"target"</span>, data=violin)</span><br><span class="line">plt.xticks(rotation=<span class="number">90</span>)</span><br><span class="line">plt.show()</span><br><span class="line"></span><br><span class="line"><span class="string">"""Difference of points (full and last 5 games), difference of points by ranking faced (full and last 5 games) and difference of rank faced (full and last 5 games) are good features. Also, some of the generated features have very similar distributions which will be analyzed using scatterplots."""</span></span><br><span class="line"></span><br><span class="line">sns.jointplot(data = data_difs, x = <span class="string">'goals_per_ranking_dif'</span>, y = <span class="string">'goals_per_ranking_dif_l5'</span>, kind=<span class="string">"reg"</span>)</span><br><span class="line">plt.show()</span><br><span class="line"></span><br><span class="line"><span class="string">"""Goals difference by ranking faced and its last 5 games version has very similar distributions. So, we will use only the full version (goals_per_ranking_dif)."""</span></span><br><span class="line"></span><br><span class="line">sns.jointplot(data = data_difs, x = <span class="string">'dif_rank_agst'</span>, y = <span class="string">'dif_rank_agst_l5'</span>, kind=<span class="string">"reg"</span>)</span><br><span class="line">plt.show()</span><br><span class="line"></span><br><span class="line">sns.jointplot(data = data_difs, x = <span class="string">'dif_points'</span>, y = <span class="string">'dif_points_l5'</span>, kind=<span class="string">"reg"</span>)</span><br><span class="line">plt.show()</span><br><span class="line"></span><br><span class="line">sns.jointplot(data = data_difs, x = <span class="string">'dif_points_rank'</span>, y = <span class="string">'dif_points_rank_l5'</span>, kind=<span class="string">"reg"</span>)</span><br><span class="line">plt.show()</span><br><span class="line"></span><br><span class="line"><span class="string">"""For the differences of rank faced, game points by rank faced and mean game points by rank faced, the two versions (full and 5 games) are not so similar. So, we will use both.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">Based on that, final features are:</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">- rank_dif</span></span><br><span class="line"><span class="string">- goals_dif</span></span><br><span class="line"><span class="string">- goals_dif_l5</span></span><br><span class="line"><span class="string">- goals_suf_dif</span></span><br><span class="line"><span class="string">- goals_suf_dif_l5</span></span><br><span class="line"><span class="string">- dif_rank_agst</span></span><br><span class="line"><span class="string">- dif_rank_agst_l5</span></span><br><span class="line"><span class="string">- goals_per_ranking_dif</span></span><br><span class="line"><span class="string">- dif_points_rank</span></span><br><span class="line"><span class="string">- dif_points_rank_l5</span></span><br><span class="line"><span class="string">- is_friendly</span></span><br><span class="line"><span class="string">"""</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">create_db</span>(<span class="params">df</span>):</span><br><span class="line">    columns = [<span class="string">"home_team"</span>, <span class="string">"away_team"</span>, <span class="string">"target"</span>, <span class="string">"rank_dif"</span>, <span class="string">"home_goals_mean"</span>, <span class="string">"home_rank_mean"</span>, <span class="string">"away_goals_mean"</span>, <span class="string">"away_rank_mean"</span>, <span class="string">"home_rank_mean_l5"</span>, <span class="string">"away_rank_mean_l5"</span>, <span class="string">"home_goals_suf_mean"</span>, <span class="string">"away_goals_suf_mean"</span>, <span class="string">"home_goals_mean_l5"</span>, <span class="string">"away_goals_mean_l5"</span>, <span class="string">"home_goals_suf_mean_l5"</span>, <span class="string">"away_goals_suf_mean_l5"</span>, <span class="string">"home_game_points_rank_mean"</span>, <span class="string">"home_game_points_rank_mean_l5"</span>, <span class="string">"away_game_points_rank_mean"</span>, <span class="string">"away_game_points_rank_mean_l5"</span>,<span class="string">"is_friendly_0"</span>, <span class="string">"is_friendly_1"</span>]</span><br><span class="line"></span><br><span class="line">    base = df.loc[:, columns]</span><br><span class="line">    base.loc[:, <span class="string">"goals_dif"</span>] = base[<span class="string">"home_goals_mean"</span>] - base[<span class="string">"away_goals_mean"</span>]</span><br><span class="line">    base.loc[:, <span class="string">"goals_dif_l5"</span>] = base[<span class="string">"home_goals_mean_l5"</span>] - base[<span class="string">"away_goals_mean_l5"</span>]</span><br><span class="line">    base.loc[:, <span class="string">"goals_suf_dif"</span>] = base[<span class="string">"home_goals_suf_mean"</span>] - base[<span class="string">"away_goals_suf_mean"</span>]</span><br><span class="line">    base.loc[:, <span class="string">"goals_suf_dif_l5"</span>] = base[<span class="string">"home_goals_suf_mean_l5"</span>] - base[<span class="string">"away_goals_suf_mean_l5"</span>]</span><br><span class="line">    base.loc[:, <span class="string">"goals_per_ranking_dif"</span>] = (base[<span class="string">"home_goals_mean"</span>] / base[<span class="string">"home_rank_mean"</span>]) - (base[<span class="string">"away_goals_mean"</span>] / base[<span class="string">"away_rank_mean"</span>])</span><br><span class="line">    base.loc[:, <span class="string">"dif_rank_agst"</span>] = base[<span class="string">"home_rank_mean"</span>] - base[<span class="string">"away_rank_mean"</span>]</span><br><span class="line">    base.loc[:, <span class="string">"dif_rank_agst_l5"</span>] = base[<span class="string">"home_rank_mean_l5"</span>] - base[<span class="string">"away_rank_mean_l5"</span>]</span><br><span class="line">    base.loc[:, <span class="string">"dif_points_rank"</span>] = base[<span class="string">"home_game_points_rank_mean"</span>] - base[<span class="string">"away_game_points_rank_mean"</span>]</span><br><span class="line">    base.loc[:, <span class="string">"dif_points_rank_l5"</span>] = base[<span class="string">"home_game_points_rank_mean_l5"</span>] - base[<span class="string">"away_game_points_rank_mean_l5"</span>]</span><br><span class="line"></span><br><span class="line">    model_df = base[[<span class="string">"home_team"</span>, <span class="string">"away_team"</span>, <span class="string">"target"</span>, <span class="string">"rank_dif"</span>, <span class="string">"goals_dif"</span>, <span class="string">"goals_dif_l5"</span>, <span class="string">"goals_suf_dif"</span>, <span class="string">"goals_suf_dif_l5"</span>, <span class="string">"goals_per_ranking_dif"</span>, <span class="string">"dif_rank_agst"</span>, <span class="string">"dif_rank_agst_l5"</span>, <span class="string">"dif_points_rank"</span>, <span class="string">"dif_points_rank_l5"</span>, <span class="string">"is_friendly_0"</span>, <span class="string">"is_friendly_1"</span>]]</span><br><span class="line">    <span class="keyword">return</span> model_df</span><br><span class="line"></span><br><span class="line">model_db = create_db(df)</span><br><span class="line"></span><br><span class="line">model_db</span><br><span class="line"></span><br><span class="line"><span class="string">"""# The model</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">Now that we have a database ready and with columns with predictive power, we can start our modelling.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">Two models will be tested: Random Forest and Gradient Boosting. The selected will be the one with best recall.</span></span><br><span class="line"><span class="string">"""</span></span><br><span class="line"></span><br><span class="line">X = model_db.iloc[:, <span class="number">3</span>:]</span><br><span class="line">y = model_db[[<span class="string">"target"</span>]]</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> sklearn.ensemble <span class="keyword">import</span> RandomForestClassifier, GradientBoostingClassifier</span><br><span class="line"><span class="keyword">from</span> sklearn.model_selection <span class="keyword">import</span> train_test_split, GridSearchCV</span><br><span class="line"></span><br><span class="line">X_train, X_test, y_train, y_test = train_test_split(X, y, test_size= <span class="number">0.2</span>, random_state=<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">gb = GradientBoostingClassifier(random_state=<span class="number">5</span>)</span><br><span class="line"></span><br><span class="line">params = {<span class="string">"learning_rate"</span>: [<span class="number">0.01</span>, <span class="number">0.1</span>, <span class="number">0.5</span>],</span><br><span class="line">            <span class="string">"min_samples_split"</span>: [<span class="number">5</span>, <span class="number">10</span>],</span><br><span class="line">            <span class="string">"min_samples_leaf"</span>: [<span class="number">3</span>, <span class="number">5</span>],</span><br><span class="line">            <span class="string">"max_depth"</span>:[<span class="number">3</span>,<span class="number">5</span>,<span class="number">10</span>],</span><br><span class="line">            <span class="string">"max_features"</span>:[<span class="string">"sqrt"</span>],</span><br><span class="line">            <span class="string">"n_estimators"</span>:[<span class="number">100</span>, <span class="number">200</span>]</span><br><span class="line">         }</span><br><span class="line"></span><br><span class="line">gb_cv = GridSearchCV(gb, params, cv = <span class="number">3</span>, n_jobs = -<span class="number">1</span>, verbose = <span class="literal">False</span>)</span><br><span class="line"></span><br><span class="line">gb_cv.fit(X_train.values, np.ravel(y_train))</span><br><span class="line"></span><br><span class="line">gb = gb_cv.best_estimator_</span><br><span class="line"></span><br><span class="line">gb</span><br><span class="line"></span><br><span class="line">params_rf = {<span class="string">"max_depth"</span>: [<span class="number">20</span>],</span><br><span class="line">                <span class="string">"min_samples_split"</span>: [<span class="number">10</span>],</span><br><span class="line">                <span class="string">"max_leaf_nodes"</span>: [<span class="number">175</span>],</span><br><span class="line">                <span class="string">"min_samples_leaf"</span>: [<span class="number">5</span>],</span><br><span class="line">                <span class="string">"n_estimators"</span>: [<span class="number">250</span>],</span><br><span class="line">                 <span class="string">"max_features"</span>: [<span class="string">"sqrt"</span>],</span><br><span class="line">                }</span><br><span class="line"></span><br><span class="line">rf = RandomForestClassifier(random_state=<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">rf_cv = GridSearchCV(rf, params_rf, cv = <span class="number">3</span>, n_jobs = -<span class="number">1</span>, verbose = <span class="literal">False</span>)</span><br><span class="line"></span><br><span class="line">rf_cv.fit(X_train.values, np.ravel(y_train))</span><br><span class="line"></span><br><span class="line">rf = rf_cv.best_estimator_</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> sklearn.metrics <span class="keyword">import</span> confusion_matrix, roc_curve, roc_auc_score</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">analyze</span>(<span class="params">model</span>):</span><br><span class="line">    fpr, tpr, _ = roc_curve(y_test, model.predict_proba(X_test.values)[:,<span class="number">1</span>]) <span class="comment">#test AUC</span></span><br><span class="line">    plt.figure(figsize=(<span class="number">15</span>,<span class="number">10</span>))</span><br><span class="line">    plt.plot([<span class="number">0</span>, <span class="number">1</span>], [<span class="number">0</span>, <span class="number">1</span>], <span class="string">'k--'</span>)</span><br><span class="line">    plt.plot(fpr, tpr, label=<span class="string">"test"</span>)</span><br><span class="line"></span><br><span class="line">    fpr_train, tpr_train, _ = roc_curve(y_train, model.predict_proba(X_train.values)[:,<span class="number">1</span>]) <span class="comment">#train AUC</span></span><br><span class="line">    plt.plot(fpr_train, tpr_train, label=<span class="string">"train"</span>)</span><br><span class="line">    auc_test = roc_auc_score(y_test, model.predict_proba(X_test.values)[:,<span class="number">1</span>])</span><br><span class="line">    auc_train = roc_auc_score(y_train, model.predict_proba(X_train.values)[:,<span class="number">1</span>])</span><br><span class="line">    plt.legend()</span><br><span class="line">    plt.title(<span class="string">'AUC score is %.2f on test and %.2f on training'</span>%(auc_test, auc_train))</span><br><span class="line">    plt.show()</span><br><span class="line"></span><br><span class="line">    plt.figure(figsize=(<span class="number">15</span>, <span class="number">10</span>))</span><br><span class="line">    cm = confusion_matrix(y_test, model.predict(X_test.values))</span><br><span class="line">    sns.heatmap(cm, annot=<span class="literal">True</span>, fmt=<span class="string">"d"</span>)</span><br><span class="line"></span><br><span class="line">analyze(gb)</span><br><span class="line"></span><br><span class="line">analyze(rf)</span><br><span class="line"></span><br><span class="line"><span class="string">"""The Random Forest model is a little bit better but seems to underfit. So, we will use the Gradient Boosting Model."""</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> operator <span class="keyword">import</span> itemgetter</span><br><span class="line"></span><br><span class="line"><span class="string">"""# WC Simulation</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">The first thing is to create FIFA World Cup games. To do this, I'll get in the wikipedia the teams and group phase matches.</span></span><br><span class="line"><span class="string">"""</span></span><br><span class="line"></span><br><span class="line">dfs = pd.read_html(<span class="string">r"https://en.wikipedia.org/wiki/2022_FIFA_World_Cup#Teams"</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> collections.abc <span class="keyword">import</span> Iterable</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(dfs)):</span><br><span class="line">    df = dfs[i]</span><br><span class="line">    cols = <span class="built_in">list</span>(df.columns.values)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">isinstance</span>(cols[<span class="number">0</span>], Iterable):</span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">any</span>(<span class="string">"Tie-breaking criteria"</span> <span class="keyword">in</span> c <span class="keyword">for</span> c <span class="keyword">in</span> cols):</span><br><span class="line">            start_pos = i+<span class="number">1</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">any</span>(<span class="string">"Match 46"</span> <span class="keyword">in</span> c <span class="keyword">for</span> c <span class="keyword">in</span> cols):</span><br><span class="line">            end_pos = i+<span class="number">1</span></span><br><span class="line"></span><br><span class="line">table = {<span class="string">'A'</span>: [[<span class="string">'Qatar'</span>, <span class="number">0</span>, []],</span><br><span class="line">  [<span class="string">'Ecuador'</span>, <span class="number">0</span>, []],</span><br><span class="line">  [<span class="string">'Senegal'</span>, <span class="number">0</span>, []],</span><br><span class="line">  [<span class="string">'Netherlands'</span>, <span class="number">0</span>, []]],</span><br><span class="line"> <span class="string">'B'</span>: [[<span class="string">'England'</span>, <span class="number">0</span>, []],</span><br><span class="line">  [<span class="string">'Iran'</span>, <span class="number">0</span>, []],</span><br><span class="line">  [<span class="string">'United States'</span>, <span class="number">0</span>, []],</span><br><span class="line">  [<span class="string">'Wales'</span>, <span class="number">0</span>, []]],</span><br><span class="line"> <span class="string">'C'</span>: [[<span class="string">'Argentina'</span>, <span class="number">0</span>, []],</span><br><span class="line">  [<span class="string">'Saudi Arabia'</span>, <span class="number">0</span>, []],</span><br><span class="line">  [<span class="string">'Mexico'</span>, <span class="number">0</span>, []],</span><br><span class="line">  [<span class="string">'Poland'</span>, <span class="number">0</span>, []]],</span><br><span class="line"> <span class="string">'D'</span>: [[<span class="string">'France'</span>, <span class="number">0</span>, []],</span><br><span class="line">  [<span class="string">'Australia'</span>, <span class="number">0</span>, []],</span><br><span class="line">  [<span class="string">'Denmark'</span>, <span class="number">0</span>, []],</span><br><span class="line">  [<span class="string">'Tunisia'</span>, <span class="number">0</span>, []]],</span><br><span class="line"> <span class="string">'E'</span>: [[<span class="string">'Spain'</span>, <span class="number">0</span>, []],</span><br><span class="line">  [<span class="string">'Costa Rica'</span>, <span class="number">0</span>, []],</span><br><span class="line">  [<span class="string">'Germany'</span>, <span class="number">0</span>, []],</span><br><span class="line">  [<span class="string">'Japan'</span>, <span class="number">0</span>, []]],</span><br><span class="line"> <span class="string">'F'</span>: [[<span class="string">'Belgium'</span>, <span class="number">0</span>, []],</span><br><span class="line">  [<span class="string">'Canada'</span>, <span class="number">0</span>, []],</span><br><span class="line">  [<span class="string">'Morocco'</span>, <span class="number">0</span>, []],</span><br><span class="line">  [<span class="string">'Croatia'</span>, <span class="number">0</span>, []]],</span><br><span class="line"> <span class="string">'G'</span>: [[<span class="string">'Brazil'</span>, <span class="number">0</span>, []],</span><br><span class="line">  [<span class="string">'Serbia'</span>, <span class="number">0</span>, []],</span><br><span class="line">  [<span class="string">'Switzerland'</span>, <span class="number">0</span>, []],</span><br><span class="line">  [<span class="string">'Cameroon'</span>, <span class="number">0</span>, []]],</span><br><span class="line"> <span class="string">'H'</span>: [[<span class="string">'Portugal'</span>, <span class="number">0</span>, []],</span><br><span class="line">  [<span class="string">'Ghana'</span>, <span class="number">0</span>, []],</span><br><span class="line">  [<span class="string">'Uruguay'</span>, <span class="number">0</span>, []],</span><br><span class="line">  [<span class="string">'South Korea'</span>, <span class="number">0</span>, []]]}</span><br><span class="line"></span><br><span class="line"><span class="comment"># method of generating matches by [caiyongji], you can search me by google</span></span><br><span class="line"><span class="comment"># welcome to follow me by wechat official account: [caiyongji]</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> itertools <span class="keyword">as</span> it</span><br><span class="line">matches = []</span><br><span class="line"><span class="keyword">for</span> k <span class="keyword">in</span> table:</span><br><span class="line">    v = table[k]</span><br><span class="line">    l = []</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> v:</span><br><span class="line">        l.append(i[<span class="number">0</span>])</span><br><span class="line">    <span class="keyword">for</span> e <span class="keyword">in</span> it.combinations(l, <span class="number">2</span>):</span><br><span class="line">        matches.append((k,e[<span class="number">0</span>],e[<span class="number">1</span>]))</span><br><span class="line"></span><br><span class="line">table</span><br><span class="line"></span><br><span class="line"><span class="string">"""Above, we also store the team's points at the group and its probabilities of win in each game. The mean of team's wins probabilities will be used as tiebreaker when two teams have the same number of points."""</span></span><br><span class="line"></span><br><span class="line">matches[:<span class="number">10</span>]</span><br><span class="line"></span><br><span class="line"><span class="string">"""I will use last game stats as the stats for each team involved in the game. Like, for Brazil vs Serbia, the stats of Brazil is the ones they had in the last game and for Serbia too."""</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">find_stats</span>(<span class="params">team_1</span>):</span><br><span class="line"><span class="comment">#team_1 = "Qatar"</span></span><br><span class="line">    past_games = team_stats_raw[(team_stats_raw[<span class="string">"team"</span>] == team_1)].sort_values(<span class="string">"date"</span>)</span><br><span class="line">    last5 = team_stats_raw[(team_stats_raw[<span class="string">"team"</span>] == team_1)].sort_values(<span class="string">"date"</span>).tail(<span class="number">5</span>)</span><br><span class="line"></span><br><span class="line">    team_1_rank = past_games[<span class="string">"rank"</span>].values[-<span class="number">1</span>]</span><br><span class="line">    team_1_goals = past_games.score.mean()</span><br><span class="line">    team_1_goals_l5 = last5.score.mean()</span><br><span class="line">    team_1_goals_suf = past_games.suf_score.mean()</span><br><span class="line">    team_1_goals_suf_l5 = last5.suf_score.mean()</span><br><span class="line">    team_1_rank_suf = past_games.rank_suf.mean()</span><br><span class="line">    team_1_rank_suf_l5 = last5.rank_suf.mean()</span><br><span class="line">    team_1_gp_rank = past_games.points_by_rank.mean()</span><br><span class="line">    team_1_gp_rank_l5 = last5.points_by_rank.mean()</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> [team_1_rank, team_1_goals, team_1_goals_l5, team_1_goals_suf, team_1_goals_suf_l5, team_1_rank_suf, team_1_rank_suf_l5, team_1_gp_rank, team_1_gp_rank_l5]</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">find_features</span>(<span class="params">team_1, team_2</span>):</span><br><span class="line">    rank_dif = team_1[<span class="number">0</span>] - team_2[<span class="number">0</span>]</span><br><span class="line">    goals_dif = team_1[<span class="number">1</span>] - team_2[<span class="number">1</span>]</span><br><span class="line">    goals_dif_l5 = team_1[<span class="number">2</span>] - team_2[<span class="number">2</span>]</span><br><span class="line">    goals_suf_dif = team_1[<span class="number">3</span>] - team_2[<span class="number">3</span>]</span><br><span class="line">    goals_suf_dif_l5 = team_1[<span class="number">4</span>] - team_2[<span class="number">4</span>]</span><br><span class="line">    goals_per_ranking_dif = (team_1[<span class="number">1</span>]/team_1[<span class="number">5</span>]) - (team_2[<span class="number">1</span>]/team_2[<span class="number">5</span>])</span><br><span class="line">    dif_rank_agst = team_1[<span class="number">5</span>] - team_2[<span class="number">5</span>]</span><br><span class="line">    dif_rank_agst_l5 = team_1[<span class="number">6</span>] - team_2[<span class="number">6</span>]</span><br><span class="line">    dif_gp_rank = team_1[<span class="number">7</span>] - team_2[<span class="number">7</span>]</span><br><span class="line">    dif_gp_rank_l5 = team_1[<span class="number">8</span>] - team_2[<span class="number">8</span>]</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> [rank_dif, goals_dif, goals_dif_l5, goals_suf_dif, goals_suf_dif_l5, goals_per_ranking_dif, dif_rank_agst, dif_rank_agst_l5, dif_gp_rank, dif_gp_rank_l5, <span class="number">1</span>, <span class="number">0</span>]</span><br><span class="line"></span><br><span class="line"><span class="string">"""Now, we are able to simulate.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">Since the model simulates if team 1 will win or not win, it's needed to create some criteria to define a draw. Also, since we have not home advantage at World Cup, the idea is to predict game two times, changing team 1 and team 2. The team with the highest mean of probabilities will be assigned as winner. At the group phase, if "home team" win as team 1 and loses as team 2, or if "home team" win as team 2 and loses at team 1, there will be assigned a draw in that match.</span></span><br><span class="line"><span class="string">"""</span></span><br><span class="line"></span><br><span class="line">advanced_group = []</span><br><span class="line">last_group = <span class="string">""</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> k <span class="keyword">in</span> table.keys():</span><br><span class="line">    <span class="keyword">for</span> t <span class="keyword">in</span> table[k]:</span><br><span class="line">        t[<span class="number">1</span>] = <span class="number">0</span></span><br><span class="line">        t[<span class="number">2</span>] = []</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> teams <span class="keyword">in</span> matches:</span><br><span class="line">    draw = <span class="literal">False</span></span><br><span class="line">    team_1 = find_stats(teams[<span class="number">1</span>])</span><br><span class="line">    team_2 = find_stats(teams[<span class="number">2</span>])</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    features_g1 = find_features(team_1, team_2)</span><br><span class="line">    features_g2 = find_features(team_2, team_1)</span><br><span class="line"></span><br><span class="line">    probs_g1 = gb.predict_proba([features_g1])</span><br><span class="line">    probs_g2 = gb.predict_proba([features_g2])</span><br><span class="line"></span><br><span class="line">    team_1_prob_g1 = probs_g1[<span class="number">0</span>][<span class="number">0</span>]</span><br><span class="line">    team_1_prob_g2 = probs_g2[<span class="number">0</span>][<span class="number">1</span>]</span><br><span class="line">    team_2_prob_g1 = probs_g1[<span class="number">0</span>][<span class="number">1</span>]</span><br><span class="line">    team_2_prob_g2 = probs_g2[<span class="number">0</span>][<span class="number">0</span>]</span><br><span class="line"></span><br><span class="line">    team_1_prob = (probs_g1[<span class="number">0</span>][<span class="number">0</span>] + probs_g2[<span class="number">0</span>][<span class="number">1</span>])/<span class="number">2</span></span><br><span class="line">    team_2_prob = (probs_g2[<span class="number">0</span>][<span class="number">0</span>] + probs_g1[<span class="number">0</span>][<span class="number">1</span>])/<span class="number">2</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> ((team_1_prob_g1 &gt; team_2_prob_g1) &amp; (team_2_prob_g2 &gt; team_1_prob_g2)) | ((team_1_prob_g1 &lt; team_2_prob_g1) &amp; (team_2_prob_g2 &lt; team_1_prob_g2)):</span><br><span class="line">        draw=<span class="literal">True</span></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> table[teams[<span class="number">0</span>]]:</span><br><span class="line">            <span class="keyword">if</span> i[<span class="number">0</span>] == teams[<span class="number">1</span>] <span class="keyword">or</span> i[<span class="number">0</span>] == teams[<span class="number">2</span>]:</span><br><span class="line">                i[<span class="number">1</span>] += <span class="number">1</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">elif</span> team_1_prob &gt; team_2_prob:</span><br><span class="line">        winner = teams[<span class="number">1</span>]</span><br><span class="line">        winner_proba = team_1_prob</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> table[teams[<span class="number">0</span>]]:</span><br><span class="line">            <span class="keyword">if</span> i[<span class="number">0</span>] == teams[<span class="number">1</span>]:</span><br><span class="line">                i[<span class="number">1</span>] += <span class="number">3</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">elif</span> team_2_prob &gt; team_1_prob:</span><br><span class="line">        winner = teams[<span class="number">2</span>]</span><br><span class="line">        winner_proba = team_2_prob</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> table[teams[<span class="number">0</span>]]:</span><br><span class="line">            <span class="keyword">if</span> i[<span class="number">0</span>] == teams[<span class="number">2</span>]:</span><br><span class="line">                i[<span class="number">1</span>] += <span class="number">3</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> table[teams[<span class="number">0</span>]]: <span class="comment">#adding criterio de desempate (probs por jogo)</span></span><br><span class="line">            <span class="keyword">if</span> i[<span class="number">0</span>] == teams[<span class="number">1</span>]:</span><br><span class="line">                i[<span class="number">2</span>].append(team_1_prob)</span><br><span class="line">            <span class="keyword">if</span> i[<span class="number">0</span>] == teams[<span class="number">2</span>]:</span><br><span class="line">                i[<span class="number">2</span>].append(team_2_prob)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> last_group != teams[<span class="number">0</span>]:</span><br><span class="line">        <span class="keyword">if</span> last_group != <span class="string">""</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">"\n"</span>)</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">"Group %s advanced: "</span>%(last_group))</span><br><span class="line"></span><br><span class="line">            <span class="keyword">for</span> i <span class="keyword">in</span> table[last_group]: <span class="comment">#adding crieterio de desempate</span></span><br><span class="line">                i[<span class="number">2</span>] = np.mean(i[<span class="number">2</span>])</span><br><span class="line"></span><br><span class="line">            final_points = table[last_group]</span><br><span class="line">            final_table = <span class="built_in">sorted</span>(final_points, key=itemgetter(<span class="number">1</span>, <span class="number">2</span>), reverse = <span class="literal">True</span>)</span><br><span class="line">            advanced_group.append([final_table[<span class="number">0</span>][<span class="number">0</span>], final_table[<span class="number">1</span>][<span class="number">0</span>]])</span><br><span class="line">            <span class="keyword">for</span> i <span class="keyword">in</span> final_table:</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">"%s -------- %d"</span>%(i[<span class="number">0</span>], i[<span class="number">1</span>]))</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">"\n"</span>)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">"-"</span>*<span class="number">10</span>+<span class="string">" Starting Analysis for Group %s "</span>%(teams[<span class="number">0</span>])+<span class="string">"-"</span>*<span class="number">10</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> draw == <span class="literal">False</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">"Group %s - %s vs. %s: Winner %s with %.2f probability"</span>%(teams[<span class="number">0</span>], teams[<span class="number">1</span>], teams[<span class="number">2</span>], winner, winner_proba))</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">"Group %s - %s vs. %s: Draw"</span>%(teams[<span class="number">0</span>], teams[<span class="number">1</span>], teams[<span class="number">2</span>]))</span><br><span class="line">    last_group =  teams[<span class="number">0</span>]</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">"\n"</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">"Group %s advanced: "</span>%(last_group))</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> table[last_group]: <span class="comment">#adding crieterio de desempate</span></span><br><span class="line">    i[<span class="number">2</span>] = np.mean(i[<span class="number">2</span>])</span><br><span class="line"></span><br><span class="line">final_points = table[last_group]</span><br><span class="line">final_table = <span class="built_in">sorted</span>(final_points, key=itemgetter(<span class="number">1</span>, <span class="number">2</span>), reverse = <span class="literal">True</span>)</span><br><span class="line">advanced_group.append([final_table[<span class="number">0</span>][<span class="number">0</span>], final_table[<span class="number">1</span>][<span class="number">0</span>]])</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> final_table:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">"%s -------- %d"</span>%(i[<span class="number">0</span>], i[<span class="number">1</span>]))</span><br><span class="line"></span><br><span class="line"><span class="string">"""The group phase predicted no surprises, or maybe the draw between Brazil and Switzerland or France and Denmark. For the playoffs phase, I'll predict and show it graphically as made [here](https://www.kaggle.com/code/agostontorok/soccer-world-cup-2018-winner)."""</span></span><br><span class="line"></span><br><span class="line">advanced = advanced_group</span><br><span class="line"></span><br><span class="line">playoffs = {<span class="string">"Round of 16"</span>: [], <span class="string">"Quarter-Final"</span>: [], <span class="string">"Semi-Final"</span>: [], <span class="string">"Final"</span>: []}</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> p <span class="keyword">in</span> playoffs.keys():</span><br><span class="line">    playoffs[p] = []</span><br><span class="line"></span><br><span class="line">actual_round = <span class="string">""</span></span><br><span class="line">next_rounds = []</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> p <span class="keyword">in</span> playoffs.keys():</span><br><span class="line">    <span class="keyword">if</span> p == <span class="string">"Round of 16"</span>:</span><br><span class="line">        control = []</span><br><span class="line">        <span class="keyword">for</span> a <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="built_in">len</span>(advanced*<span class="number">2</span>), <span class="number">1</span>):</span><br><span class="line">            <span class="keyword">if</span> a &lt; <span class="built_in">len</span>(advanced):</span><br><span class="line">                <span class="keyword">if</span> a % <span class="number">2</span> == <span class="number">0</span>:</span><br><span class="line">                    control.append((advanced*<span class="number">2</span>)[a][<span class="number">0</span>])</span><br><span class="line">                <span class="keyword">else</span>:</span><br><span class="line">                    control.append((advanced*<span class="number">2</span>)[a][<span class="number">1</span>])</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                <span class="keyword">if</span> a % <span class="number">2</span> == <span class="number">0</span>:</span><br><span class="line">                    control.append((advanced*<span class="number">2</span>)[a][<span class="number">1</span>])</span><br><span class="line">                <span class="keyword">else</span>:</span><br><span class="line">                    control.append((advanced*<span class="number">2</span>)[a][<span class="number">0</span>])</span><br><span class="line"></span><br><span class="line">        playoffs[p] = [[control[c], control[c+<span class="number">1</span>]] <span class="keyword">for</span> c <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="built_in">len</span>(control)-<span class="number">1</span>, <span class="number">1</span>) <span class="keyword">if</span> c%<span class="number">2</span> == <span class="number">0</span>]</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="built_in">len</span>(playoffs[p]), <span class="number">1</span>):</span><br><span class="line">            game = playoffs[p][i]</span><br><span class="line"></span><br><span class="line">            home = game[<span class="number">0</span>]</span><br><span class="line">            away = game[<span class="number">1</span>]</span><br><span class="line">            team_1 = find_stats(home)</span><br><span class="line">            team_2 = find_stats(away)</span><br><span class="line"></span><br><span class="line">            features_g1 = find_features(team_1, team_2)</span><br><span class="line">            features_g2 = find_features(team_2, team_1)</span><br><span class="line"></span><br><span class="line">            probs_g1 = gb.predict_proba([features_g1])</span><br><span class="line">            probs_g2 = gb.predict_proba([features_g2])</span><br><span class="line"></span><br><span class="line">            team_1_prob = (probs_g1[<span class="number">0</span>][<span class="number">0</span>] + probs_g2[<span class="number">0</span>][<span class="number">1</span>])/<span class="number">2</span></span><br><span class="line">            team_2_prob = (probs_g2[<span class="number">0</span>][<span class="number">0</span>] + probs_g1[<span class="number">0</span>][<span class="number">1</span>])/<span class="number">2</span></span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> actual_round != p:</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">"-"</span>*<span class="number">10</span>)</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">"Starting simulation of %s"</span>%(p))</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">"-"</span>*<span class="number">10</span>)</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">"\n"</span>)</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> team_1_prob &lt; team_2_prob:</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">"%s vs. %s: %s advances with prob %.2f"</span>%(home, away, away, team_2_prob))</span><br><span class="line">                next_rounds.append(away)</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">"%s vs. %s: %s advances with prob %.2f"</span>%(home, away, home, team_1_prob))</span><br><span class="line">                next_rounds.append(home)</span><br><span class="line"></span><br><span class="line">            game.append([team_1_prob, team_2_prob])</span><br><span class="line">            playoffs[p][i] = game</span><br><span class="line">            actual_round = p</span><br><span class="line"></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        playoffs[p] = [[next_rounds[c], next_rounds[c+<span class="number">1</span>]] <span class="keyword">for</span> c <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="built_in">len</span>(next_rounds)-<span class="number">1</span>, <span class="number">1</span>) <span class="keyword">if</span> c%<span class="number">2</span> == <span class="number">0</span>]</span><br><span class="line">        next_rounds = []</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="built_in">len</span>(playoffs[p])):</span><br><span class="line">            game = playoffs[p][i]</span><br><span class="line">            home = game[<span class="number">0</span>]</span><br><span class="line">            away = game[<span class="number">1</span>]</span><br><span class="line">            team_1 = find_stats(home)</span><br><span class="line">            team_2 = find_stats(away)</span><br><span class="line"></span><br><span class="line">            features_g1 = find_features(team_1, team_2)</span><br><span class="line">            features_g2 = find_features(team_2, team_1)</span><br><span class="line"></span><br><span class="line">            probs_g1 = gb.predict_proba([features_g1])</span><br><span class="line">            probs_g2 = gb.predict_proba([features_g2])</span><br><span class="line"></span><br><span class="line">            team_1_prob = (probs_g1[<span class="number">0</span>][<span class="number">0</span>] + probs_g2[<span class="number">0</span>][<span class="number">1</span>])/<span class="number">2</span></span><br><span class="line">            team_2_prob = (probs_g2[<span class="number">0</span>][<span class="number">0</span>] + probs_g1[<span class="number">0</span>][<span class="number">1</span>])/<span class="number">2</span></span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> actual_round != p:</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">"-"</span>*<span class="number">10</span>)</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">"Starting simulation of %s"</span>%(p))</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">"-"</span>*<span class="number">10</span>)</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">"\n"</span>)</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> team_1_prob &lt; team_2_prob:</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">"%s vs. %s: %s advances with prob %.2f"</span>%(home, away, away, team_2_prob))</span><br><span class="line">                next_rounds.append(away)</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">"%s vs. %s: %s advances with prob %.2f"</span>%(home, away, home, team_1_prob))</span><br><span class="line">                next_rounds.append(home)</span><br><span class="line">            game.append([team_1_prob, team_2_prob])</span><br><span class="line">            playoffs[p][i] = game</span><br><span class="line">            actual_round = p</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> networkx <span class="keyword">as</span> nx</span><br><span class="line"><span class="keyword">from</span> networkx.drawing.nx_pydot <span class="keyword">import</span> graphviz_layout</span><br><span class="line"></span><br><span class="line">plt.figure(figsize=(<span class="number">15</span>, <span class="number">10</span>))</span><br><span class="line">G = nx.balanced_tree(<span class="number">2</span>, <span class="number">3</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">labels = []</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> p <span class="keyword">in</span> playoffs.keys():</span><br><span class="line">    <span class="keyword">for</span> game <span class="keyword">in</span> playoffs[p]:</span><br><span class="line">        label = <span class="string">f"<span class="subst">{game[<span class="number">0</span>]}</span>(<span class="subst">{<span class="built_in">round</span>(game[<span class="number">2</span>][<span class="number">0</span>], <span class="number">2</span>)}</span>) \n <span class="subst">{game[<span class="number">1</span>]}</span>(<span class="subst">{<span class="built_in">round</span>(game[<span class="number">2</span>][<span class="number">1</span>], <span class="number">2</span>)}</span>)"</span></span><br><span class="line">        labels.append(label)</span><br><span class="line"></span><br><span class="line">labels_dict = {}</span><br><span class="line">labels_rev = <span class="built_in">list</span>(<span class="built_in">reversed</span>(labels))</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> l <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(<span class="built_in">list</span>(G.nodes))):</span><br><span class="line">    labels_dict[l] = labels_rev[l]</span><br><span class="line"></span><br><span class="line">pos = graphviz_layout(G, prog=<span class="string">'twopi'</span>)</span><br><span class="line">labels_pos = {n: (k[<span class="number">0</span>], k[<span class="number">1</span>]-<span class="number">0.08</span>*k[<span class="number">1</span>]) <span class="keyword">for</span> n,k <span class="keyword">in</span> pos.items()}</span><br><span class="line">center  = pd.DataFrame(pos).mean(axis=<span class="number">1</span>).mean()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">nx.draw(G, pos = pos, with_labels=<span class="literal">False</span>, node_color=<span class="built_in">range</span>(<span class="number">15</span>), edge_color=<span class="string">"#bbf5bb"</span>, width=<span class="number">10</span>, font_weight=<span class="string">'bold'</span>,cmap=plt.cm.Greens, node_size=<span class="number">5000</span>)</span><br><span class="line">nx.draw_networkx_labels(G, pos = labels_pos, bbox=<span class="built_in">dict</span>(boxstyle=<span class="string">"round,pad=0.3"</span>, fc=<span class="string">"white"</span>, ec=<span class="string">"black"</span>, lw=<span class="number">.5</span>, alpha=<span class="number">1</span>),</span><br><span class="line">                        labels=labels_dict)</span><br><span class="line">texts = [<span class="string">"Round \nof 16"</span>, <span class="string">"Quarter \n Final"</span>, <span class="string">"Semi \n Final"</span>, <span class="string">"Final\n"</span>]</span><br><span class="line">pos_y = pos[<span class="number">0</span>][<span class="number">1</span>] + <span class="number">55</span></span><br><span class="line"><span class="keyword">for</span> text <span class="keyword">in</span> <span class="built_in">reversed</span>(texts):</span><br><span class="line">    pos_x = center</span><br><span class="line">    pos_y -= <span class="number">75</span></span><br><span class="line">    plt.text(pos_y, pos_x, text, fontsize = <span class="number">18</span>)</span><br><span class="line"></span><br><span class="line">plt.axis(<span class="string">'equal'</span>)</span><br><span class="line">plt.show()</span><br><span class="line"></span><br><span class="line"><span class="string">"""And that's the final simulation! Brazil has won the 6th title! Hoping that my predictions are correct now.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">It's nice to analyze too the possible upsets. Belgium passed against Germany, and were defeated by Portugal. Argentina - Netherlands game is very tight, with Netherlands passing by nearly 1%. The same happens between France and England, with England passing. I think England as finalist was the biggest upset of the simulation.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">Update: the databases were updated with the last friendlies that national teams played before the World Cup, and, with that, some simulations changed. France now beats England at quarter-final, and they are defeated by Portugal in the semis! Portugal at the finals is a huge surprise!</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"># Conclusion</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">The goal of this was to improve my knowledge with Machine Learning simulating something that I love (Football World Cup). I think that's amazing to create models that we can see the result in real life, and that's what is going to happen!</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">In general, I think that the model predicted like the common sense of people who watch football. There are not huge surprises in the simulation. It's also nice to see games with teams that are more unkown in group phase, like Iran vs. Wales or Senegal vs. Ecuador. I think that in games like that, the model is a good guidance to betting, since the knowledge of most people second tier national teams is not great.</span></span><br><span class="line"><span class="string">"""</span></span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>
</div><div class="index-category-tag"><div class="level-item"><i class="fas fa-folder-open has-text-grey"> </i><a class="article-more button is-small link-muted index-categories" href="/categories/CS/">CS</a><span> </span><a class="article-more button is-small link-muted index-categories" href="/categories/CS/%E7%AC%94%E8%AE%B0/">笔记</a></div>  <div class="level-item"><i class="fas fa-tags has-text-grey"> </i><a class="article-more button is-small link-muted index-tags" href="/tags/%E7%AC%94%E8%AE%B0/">笔记</a><span> </span><a class="article-more button is-small link-muted index-tags" href="/tags/CIE/">CIE</a><span> </span><a class="article-more button is-small link-muted index-tags" href="/tags/%E8%AE%A1%E7%AE%97%E6%9C%BA/">计算机</a></div><hr></div></article></div><div class="card"><div class="card-image"><a class="image is-7by3" href="/2022/09/01/ASCS%E7%AC%94%E8%AE%B0/"><img class="fill" src="/thumbnails/CS.jpg" alt="ASCS笔记"></a></div><article class="card-content article" role="article"><div class="article-meta size-small is-uppercase level is-mobile"><div class="level-left"><i class="far fa-calendar-plus"> </i>2022-09-01  <a class="commentCountImg" href="/2022/09/01/ASCS%E7%AC%94%E8%AE%B0/#comment-container"><span class="display-none-class">cd3959d276fa3caf2a7f842749b93dc0</span><i class="far fa-comment-dots"></i> <span class="commentCount" id="cd3959d276fa3caf2a7f842749b93dc0">99+</span>  </a><span class="level-item"><i class="far fa-clock"> </i>9 小时  <i class="fas fa-pencil-alt"> </i>84.7 k</span></div><div class="pin-icon"><i class="fas fa-thumbtack"></i></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2022/09/01/ASCS%E7%AC%94%E8%AE%B0/">ASCS笔记</a></h1><div class="content"><blockquote>
<p>CS课堂笔记<br></div><div class="index-category-tag"><div class="level-item"><i class="fas fa-folder-open has-text-grey"> </i><a class="article-more button is-small link-muted index-categories" href="/categories/CS/">CS</a><span> </span><a class="article-more button is-small link-muted index-categories" href="/categories/CS/%E7%AC%94%E8%AE%B0/">笔记</a></div>  <div class="level-item"><i class="fas fa-tags has-text-grey"> </i><a class="article-more button is-small link-muted index-tags" href="/tags/%E7%AC%94%E8%AE%B0/">笔记</a><span> </span><a class="article-more button is-small link-muted index-tags" href="/tags/CIE/">CIE</a><span> </span><a class="article-more button is-small link-muted index-tags" href="/tags/%E8%AE%A1%E7%AE%97%E6%9C%BA/">计算机</a></div><hr></div><div class="level is-mobile is-flex"><div class="level-start"><div class="level-item"><a class="article-more button is-small size-small" href="/2022/09/01/ASCS%E7%AC%94%E8%AE%B0/#more">阅读更多&gt;&gt;</a></div></div><div class="level-start"><div class="level-item has-text-grey is-size-7"><time dateTime="2023-06-10T03:03:00.740Z"><i class="far fa-calendar-check"> 最后修改: </i>2023-06-10</time></div></div></div></article></div><div class="card"><div class="card-image"><a class="image is-7by3" href="/2022/08/24/Latex%E8%87%AA%E5%AD%A6%E7%AC%94%E8%AE%B0/"><img class="fill" src="/thumbnails/LaTeX自学笔记.png" alt="LaTeX自学笔记"></a></div><article class="card-content article" role="article"><div class="article-meta size-small is-uppercase level is-mobile"><div class="level-left"><i class="far fa-calendar-plus"> </i>2022-08-24  <a class="commentCountImg" href="/2022/08/24/Latex%E8%87%AA%E5%AD%A6%E7%AC%94%E8%AE%B0/#comment-container"><span class="display-none-class">877c9657cb399e900cecca4b0103da4b</span><i class="far fa-comment-dots"></i> <span class="commentCount" id="877c9657cb399e900cecca4b0103da4b">99+</span>  </a><span class="level-item"><i class="far fa-clock"> </i>27 分钟  <i class="fas fa-pencil-alt"> </i>4.0 k</span></div><div class="pin-icon"><i class="fas fa-thumbtack"></i></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2022/08/24/Latex%E8%87%AA%E5%AD%A6%E7%AC%94%E8%AE%B0/">LaTeX自学笔记</a></h1><div class="content"><blockquote>
<p>本人自学LaTeX非系统性笔记，随学习进度不断更新<br></div><div class="index-category-tag"><div class="level-item"><i class="fas fa-folder-open has-text-grey"> </i><a class="article-more button is-small link-muted index-categories" href="/categories/LaTeX/">LaTeX</a><span> </span><a class="article-more button is-small link-muted index-categories" href="/categories/LaTeX/%E8%87%AA%E5%AD%A6%E7%AC%94%E8%AE%B0/">自学笔记</a></div>  <div class="level-item"><i class="fas fa-tags has-text-grey"> </i><a class="article-more button is-small link-muted index-tags" href="/tags/LaTeX/">LaTeX</a><span> </span><a class="article-more button is-small link-muted index-tags" href="/tags/%E7%AC%94%E8%AE%B0/">笔记</a></div><hr></div><div class="level is-mobile is-flex"><div class="level-start"><div class="level-item"><a class="article-more button is-small size-small" href="/2022/08/24/Latex%E8%87%AA%E5%AD%A6%E7%AC%94%E8%AE%B0/#more">阅读更多&gt;&gt;</a></div></div><div class="level-start"><div class="level-item has-text-grey is-size-7"><time dateTime="2023-06-10T02:58:26.980Z"><i class="far fa-calendar-check"> 最后修改: </i>2023-06-10</time></div></div></div></article></div></div><div class="column column-left is-4-tablet is-4-desktop is-3-widescreen  order-1 is-sticky"><div class="card widget" data-type="profile"><div class="card-content"><nav class="level"><div class="level-item has-text-centered flex-shrink-1"><div><figure class="image is-128x128 mx-auto mb-2"><img class="avatar is-rounded" src="/img/avatar.png" alt="闰土家的猹"></figure><p class="title is-size-4 is-block" style="line-height:inherit;">闰土家的猹</p><p class="is-size-6 is-block">学习如逆水行舟，不进则退。</p><p class="is-size-6 is-flex justify-content-center"><i class="fas fa-map-marker-alt mr-1"></i><span>太阳系</span></p></div></div></nav><nav class="level is-mobile"><div class="level-item has-text-centered is-marginless"><div><p class="heading">文章</p><a href="/archives"><p class="title">11</p></a></div></div><div class="level-item has-text-centered is-marginless"><div><p class="heading">分类</p><a href="/categories"><p class="title">12</p></a></div></div><div class="level-item has-text-centered is-marginless"><div><p class="heading">标签</p><a href="/tags"><p class="title">10</p></a></div></div></nav><div class="level"><a class="level-item button is-primary is-rounded" href="https://github.com/NaughtyChas" target="_blank" rel="noopener">关注我</a></div><div class="level is-mobile"><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="Github" href="https://github.com/NaughtyChas"><i class="fab fa-github"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="Zhihu" href="https://www.zhihu.com/people/run-tu-jia-de-zha-5"><i class="fab fa-zhihu"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="Bilibili" href="https://space.bilibili.com/249598523"><i class="fab fa-bilibili"></i></a></div><div><hr><p id="hitokoto">:D 一言句子获取中...</p><script type="text/javascript" defer>function getYiyan(){
                                $.getJSON("https://v1.hitokoto.cn/", function (data) {
                                if(data){
                                    $('#hitokoto').html("");
                                    $('#hitokoto').append("<strong style='color: #3273dc;'>"+data.hitokoto+"</strong>"+
                                    "<p>"+"来源《"+data.from+"》</p><p>提供者-"+data.creator+"</p>");
                                }});}
                                $(function (){getYiyan();$('#hitokoto').click(function(){getYiyan();})});</script></div></div></div><div class="card widget" data-type="links"><div class="card-content"><div class="menu"><h3 class="menu-label">链接</h3><ul class="menu-list"><li><a class="level is-mobile" href="https://hexo.io" target="_blank" rel="noopener"><span class="level-left"><span class="level-item">Hexo</span></span><span class="level-right"><span class="level-item tag">hexo.io</span></span></a></li></ul></div></div></div><div class="column-right-shadow is-hidden-widescreen"></div></div><div class="column column-right is-4-tablet is-4-desktop is-3-widescreen is-hidden-touch is-hidden-desktop-only order-3"><!--!--><div class="card widget"><div class="card-content"><h3 class="menu-label">最新评论</h3><span class="body_hot_comment">加载中，最新评论有1分钟缓存...</span></div></div><div class="card widget"><div class="card-content"><h3 class="menu-label">最新文章</h3><article class="media"><figure class="media-left"><a class="image" href="/2023/07/01/A2CS%E7%AC%94%E8%AE%B0/"><img src="/thumbnails/CS.jpg" alt="A2CS笔记"></a></figure><div class="media-content"><p class="date"><time dateTime="2023-07-01T09:18:28.000Z">2023-07-01</time></p><p class="title"><a href="/2023/07/01/A2CS%E7%AC%94%E8%AE%B0/">A2CS笔记</a></p><p class="categories"><a href="/categories/CS/">CS</a> / <a href="/categories/CS/%E7%AC%94%E8%AE%B0/">笔记</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2023-06-09T16:00:00.000Z">2023-06-10</time></p><p class="title"><a href="/2023/06/10/%E6%9C%89%E5%85%B3%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0/%E6%9C%89%E5%85%B3%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0/">有关深度学习</a></p><p class="categories"><a href="/categories/CS/">CS</a> / <a href="/categories/CS/%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0/">深度学习</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2022-12-01T16:00:00.000Z">2022-12-02</time></p><p class="title"><a href="/2022/12/02/%E9%9F%B3%E6%95%88%E5%BA%93/">音效库</a></p><p class="categories"><a href="/categories/%E6%9D%82%E6%96%87/">杂文</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2022-09-05T14:41:05.000Z">2022-09-05</time></p><p class="title"><a href="/2022/09/05/%E4%BD%A0%E8%AF%B4%E5%BE%97%E5%AF%B9/">收集&quot;你说得对&quot;</a></p><p class="categories"><a href="/categories/%E6%9D%82%E6%96%87/">杂文</a></p></div></article><article class="media"><figure class="media-left"><a class="image" href="/2022/09/01/ASCS%E7%AC%94%E8%AE%B0/"><img src="/thumbnails/CS.jpg" alt="ASCS笔记"></a></figure><div class="media-content"><p class="date"><time dateTime="2022-09-01T13:33:28.000Z">2022-09-01</time></p><p class="title"><a href="/2022/09/01/ASCS%E7%AC%94%E8%AE%B0/">ASCS笔记</a></p><p class="categories"><a href="/categories/CS/">CS</a> / <a href="/categories/CS/%E7%AC%94%E8%AE%B0/">笔记</a></p></div></article></div></div><div class="card widget"><div class="card-content"><div class="menu"><h3 class="menu-label">分类</h3><ul class="menu-list"><li><a class="level is-mobile is-marginless" href="/categories/CIE%E4%B8%8E%E8%80%83%E8%AF%95/"><span class="level-start"><span class="level-item">CIE与考试</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile is-marginless" href="/categories/CS/"><span class="level-start"><span class="level-item">CS</span></span><span class="level-end"><span class="level-item tag">4</span></span></a><ul class="mr-0"><li><a class="level is-mobile is-marginless" href="/categories/CS/%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0/"><span class="level-start"><span class="level-item">深度学习</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile is-marginless" href="/categories/CS/%E7%AC%94%E8%AE%B0/"><span class="level-start"><span class="level-item">笔记</span></span><span class="level-end"><span class="level-item tag">3</span></span></a></li></ul></li><li><a class="level is-mobile is-marginless" href="/categories/LaTeX/"><span class="level-start"><span class="level-item">LaTeX</span></span><span class="level-end"><span class="level-item tag">1</span></span></a><ul class="mr-0"><li><a class="level is-mobile is-marginless" href="/categories/LaTeX/%E8%87%AA%E5%AD%A6%E7%AC%94%E8%AE%B0/"><span class="level-start"><span class="level-item">自学笔记</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li></ul></li><li><a class="level is-mobile is-marginless" href="/categories/%E6%95%B0%E5%AD%A6/"><span class="level-start"><span class="level-item">数学</span></span><span class="level-end"><span class="level-item tag">1</span></span></a><ul class="mr-0"><li><a class="level is-mobile is-marginless" href="/categories/%E6%95%B0%E5%AD%A6/%E9%A2%98%E7%9B%AE%E7%A7%AF%E7%B4%AF/"><span class="level-start"><span class="level-item">题目积累</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li></ul></li><li><a class="level is-mobile is-marginless" href="/categories/%E6%97%A5%E5%B8%B8/"><span class="level-start"><span class="level-item">日常</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile is-marginless" href="/categories/%E6%97%A5%E5%BF%97/"><span class="level-start"><span class="level-item">日志</span></span><span class="level-end"><span class="level-item tag">1</span></span></a><ul class="mr-0"></ul></li><a class="level is-mobile is-marginless" href="/categories/"><span class="level-start"><span class="level-item">查看全部&gt;&gt;</span></span></a></ul></div></div></div><div class="card widget"><div class="card-content"><div class="menu"><h3 class="menu-label">归档</h3><ul class="menu-list"><li><a class="level is-mobile is-marginless" href="/archives/2023/07/"><span class="level-start"><span class="level-item">七月 2023</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2023/06/"><span class="level-start"><span class="level-item">六月 2023</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2022/12/"><span class="level-start"><span class="level-item">十二月 2022</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2022/09/"><span class="level-start"><span class="level-item">九月 2022</span></span><span class="level-end"><span class="level-item tag">3</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2022/08/"><span class="level-start"><span class="level-item">八月 2022</span></span><span class="level-end"><span class="level-item tag">5</span></span></a></li><a class="level is-mobile is-marginless" href="/archives/"><span class="level-start"><span class="level-item">查看全部&gt;&gt;</span></span></a></ul></div></div></div><div class="card widget"><div class="card-content"><div class="menu"><h3 class="menu-label">标签</h3><div class="field is-grouped is-grouped-multiline"><div class="control"><a class="tags has-addons" href="/tags/%E7%AC%94%E8%AE%B0/"><span class="tag">笔记</span><span class="tag is-grey-lightest">5</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E8%AE%A1%E7%AE%97%E6%9C%BA/"><span class="tag">计算机</span><span class="tag is-grey-lightest">4</span></a></div><div class="control"><a class="tags has-addons" href="/tags/CIE/"><span class="tag">CIE</span><span class="tag is-grey-lightest">3</span></a></div><div class="control"><a class="tags has-addons" href="/tags/memes/"><span class="tag">memes</span><span class="tag is-grey-lightest">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/LaTeX/"><span class="tag">LaTeX</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/My-Self/"><span class="tag">My Self</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E4%BE%8B%E9%A2%98/"><span class="tag">例题</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E5%AD%A6%E4%B8%9A%E5%8E%86%E7%A8%8B/"><span class="tag">学业历程</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E6%95%B0%E5%AD%A6/"><span class="tag">数学</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E6%97%A5%E5%BF%97/"><span class="tag">日志</span><span class="tag is-grey-lightest">1</span></a></div></div></div></div></div></div></div></div></section><footer class="footer"><div class="container"><div class="level"><div class="level-start"><a class="footer-logo is-block mb-2" href="/"><img src="/img/logo.png" alt="ntcs&#039; blog" height="28"></a><p class="size-small"><span>&copy; 2023 MXK</span>  Powered by <a href="https://hexo.io/" target="_blank" rel="noreferrer">Hexo</a> &amp; <a href="https://github.com/ppoffice/hexo-theme-icarus" target="_blank" rel="noreferrer">Icarus</a> &amp; <a href="https://github.com/LittleYe233/hexo-theme-amazingremake" target="_blank" rel="noreferrer">Amazing-Remake</a> <br><span>© 版权说明：[本网站所有内容均收集于互联网或自己创作,<br />&nbsp;&nbsp;&nbsp;&nbsp;方便于网友与自己学习交流，如有侵权，请<a href="/message" target="_blank">留言</a>，立即处理]<br /></span><span><span id="statistic-times">loading...</span><script>function createTime(time) {
            var n = new Date(time);
            now.setTime(now.getTime() + 250),
                days = (now - n) / 1e3 / 60 / 60 / 24,
                dnum = Math.floor(days),
                hours = (now - n) / 1e3 / 60 / 60 - 24 * dnum,
                hnum = Math.floor(hours),
            1 == String(hnum).length && (hnum = "0" + hnum),
                minutes = (now - n) / 1e3 / 60 - 1440 * dnum - 60 * hnum,
                mnum = Math.floor(minutes),
            1 == String(mnum).length && (mnum = "0" + mnum),
                seconds = (now - n) / 1e3 - 86400 * dnum - 3600 * hnum - 60 * mnum,
                snum = Math.round(seconds),
            1 == String(snum).length && (snum = "0" + snum),
                document.getElementById("statistic-times").innerHTML = "❤️本站自 <strong>"+time.split(" ")[0].replace(/\//g,".")+"</strong> 已运行 <strong>" + dnum + "</strong> 天 <strong>" + hnum + "</strong> 小时 <strong>" + mnum + "</strong> 分 <strong>" + snum + "</strong> 秒！❤️";
        }var now = new Date();setInterval("createTime('2022.8.11 17:07:12')", 250,"");</script><br></span><div class="size-small"><span>❤️感谢 <strong><span id="busuanzi_value_site_uv">99+</span></strong> 小伙伴的 <strong><span id="busuanzi_value_site_pv">99+</span></strong> 次光临！❤️</span></div></p></div><div class="level-end"><div class="field has-addons"><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Creative Commons" href="https://creativecommons.org/"><i class="fab fa-creative-commons"></i></a></p><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Attribution 4.0 International" href="https://creativecommons.org/licenses/by/4.0/"><i class="fab fa-creative-commons-by"></i></a></p><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Download on GitHub" href="https://github.com/LittleYe233/hexo-theme-amazingremake"><i class="fab fa-github"></i></a></p></div></div></div></div></footer><script src="https://cdn.jsdelivr.net/npm/moment@2.22.2/min/moment-with-locales.min.js"></script><script src="https://cdn.jsdelivr.net/npm/clipboard@2.0.4/dist/clipboard.min.js" async></script><script>moment.locale("zh-CN");</script><script>var IcarusThemeSettings = {
            article: {
                highlight: {
                    enabled: true,
                    clipboard: true,
                    fold: 'unfolded'
                }
            }
        };</script><script src="/js/column.js"></script><script src="/js/animation.js"></script><a id="back-to-top" title="回到顶端" href="javascript:;"><i class="fas fa-chevron-up"></i></a><script src="/js/back_to_top.js" defer></script><!--!--><!--!--><!--!--><script src="https://cdn.jsdelivr.net/npm/lightgallery@1.10.0/dist/js/lightgallery.min.js" defer></script><script src="https://cdn.jsdelivr.net/npm/justifiedGallery@3.8.1/dist/js/jquery.justifiedGallery.min.js" defer></script><script>window.addEventListener("load", () => {
            if (typeof $.fn.lightGallery === 'function') {
                $('.article').lightGallery({ selector: '.gallery-item' });
            }
            if (typeof $.fn.justifiedGallery === 'function') {
                if ($('.justified-gallery > p > .gallery-item').length) {
                    $('.justified-gallery > p > .gallery-item').unwrap();
                }
                $('.justified-gallery').justifiedGallery();
            }
        });</script><!--!--><!--!--><script type="text/x-mathjax-config">MathJax.Hub.Config({
            'HTML-CSS': {
                matchFontHeight: false
            },
            SVG: {
                matchFontHeight: false
            },
            CommonHTML: {
                matchFontHeight: false
            },
            tex2jax: {
                inlineMath: [
                    ['$','$'],
                    ['\\(','\\)']
                ]
            }
        });</script><script src="https://cdn.jsdelivr.net/npm/mathjax@2.7.9/unpacked/MathJax.js?config=TeX-MML-AM_CHTML" defer></script><!--!--><script src="/js/main.js" defer></script><script>$.getScript('/js/comment-issue-data.js',function(){loadIssueData('b602cb01d4c2668b35ae','0a26ed5993551a9754281410ba3aa5f772dfbdf2','NaughtyChas','Blog-Comment',false);})</script><div class="searchbox"><div class="searchbox-container"><div class="searchbox-header"><div class="searchbox-input-container"><input class="searchbox-input" type="text" placeholder="想要查找什么..."></div><a class="searchbox-close" href="javascript:;">×</a></div><div class="searchbox-body"></div></div></div><script src="/js/insight.js" defer></script><script>document.addEventListener('DOMContentLoaded', function () {
            loadInsight({"contentUrl":"/content.json"}, {"hint":"想要查找什么...","untitled":"(无标题)","posts":"文章","pages":"页面","categories":"分类","tags":"标签"});
        });</script><script src="https://cdn.jsdelivr.net/npm/pjax@0.2.8/pjax.js"></script><script type="text/javascript">var pjax = new Pjax({
            elements: "a",//代表点击链接就更新
            selectors: [  //代表要更新的节点
                ".section",
                "title"
            ],
            cache: true,
            cacheBust:false
        })

        function loadBusuanzi(){
        $.getScript("//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js", function () {});
        }

        function loadMathJax() { // 加载mathjax
            window.MathJax = {
                tex: {
                    inlineMath: [['$', '$']],
                    autoload: {
                        color: [],
                        colorv2: ['color']
                    },
                    packages: {'[+]': ['noerrors']}
                },
                options: {
                    ignoreHtmlClass: 'tex2jax_ignore',
                    processHtmlClass: 'tex2jax_process'
                },
                loader: {
                    load: ['input/asciimath', '[tex]/noerrors']
                }
            };
            $.getScript('//cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js');
        };

        // 开始 PJAX 执行的函数
        document.addEventListener('pjax:send', function () {
        });
        
        // PJAX 完成之后执行的函数，可以和上面的重载放在一起
        document.addEventListener('pjax:complete', function () {
            $(".section").css({opacity:1});
            if(true){
                $.getScript('/js/comment-issue-data.js',function(){loadIssueData('b602cb01d4c2668b35ae','0a26ed5993551a9754281410ba3aa5f772dfbdf2','NaughtyChas','Blog-Comment',false);});
            }
            if('undefined' === 'mathjax'){
                loadMathJax();
            }
            loadMainJs(jQuery, window.moment, window.ClipboardJS, window.IcarusThemeSettings);
            loadBackTop();
            loadBusuanzi();
            if(typeof loadBanner == 'function'){
                loadBanner();
            }
        });</script></body></html>